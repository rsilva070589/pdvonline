{"ast":null,"code":"import { createElementVNode as _createElementVNode, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"margin-top\": \"-90px\"\n  }\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"font-size\": \"35px\"\n  }\n}, \" Fechamento Caixa \", -1\n/* HOISTED */\n);\n\nconst _hoisted_3 = {\n  style: {\n    \"display\": \"flex\"\n  }\n};\nconst _hoisted_4 = {\n  key: 0,\n  style: {\n    \"margin-top\": \"17px\"\n  }\n};\nconst _hoisted_5 = {\n  key: 0,\n  style: {\n    \"padding\": \"10px 45px 0px 0px\",\n    \"width\": \"500px\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"background-color\": \"white\"\n  },\n  role: \"table\",\n  \"aria-busy\": \"false\",\n  \"aria-colcount\": \"5\",\n  class: \"table b-table table-hover\",\n  id: \"__BVID__310\"\n};\n\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"thead\", {\n  role: \"rowgroup\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"tr\", {\n  role: \"row\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"th\", {\n  role: \"columnheader\",\n  scope: \"col\",\n  \"aria-colindex\": \"1\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"div\", null, \"#\")]), /*#__PURE__*/_createElementVNode(\"th\", {\n  role: \"columnheader\",\n  scope: \"col\",\n  \"aria-colindex\": \"2\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"div\", null, \"TIPO\")]), /*#__PURE__*/_createElementVNode(\"th\", {\n  role: \"columnheader\",\n  scope: \"col\",\n  \"aria-colindex\": \"3\",\n  class: \"\",\n  style: {\n    \"text-align\": \"center\"\n  }\n}, [/*#__PURE__*/_createElementVNode(\"div\", null, \"R$\")])])], -1\n/* HOISTED */\n);\n\nconst _hoisted_8 = {\n  role: \"row\",\n  class: \"\"\n};\nconst _hoisted_9 = {\n  \"aria-colindex\": \"1\",\n  role: \"cell\",\n  class: \"\"\n};\nconst _hoisted_10 = {\n  \"aria-colindex\": \"2\",\n  role: \"cell\",\n  class: \"\"\n};\nconst _hoisted_11 = {\n  \"aria-colindex\": \"3\",\n  role: \"cell\",\n  style: {\n    \"text-align\": \"right\"\n  }\n};\n\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"td\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_13 = {\n  style: {\n    \"text-align\": \"right\",\n    \"font-size\": \"20px\",\n    \"color\": \"blue\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", null, [_createVNode($setup[\"Filtros\"])]), $setup.store.filtro.dataInicial && $setup.store.filtro.dataFinal ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", {\n    style: {\n      \"background-color\": \"rgb(153, 193, 134)\",\n      \"margin-top\": \"35px\",\n      \"height\": \"35px\"\n    },\n    class: \"btn btn-primary mt-3\",\n    onClick: _cache[0] || (_cache[0] = $event => $setup.getVendas($setup.tomorrow($setup.store.filtro.dataInicial), $setup.tomorrow($setup.store.filtro.dataFinal)))\n  }, \" buscar \")])) : _createCommentVNode(\"v-if\", true)]), !$setup.store.editando ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"table\", _hoisted_6, [_hoisted_7, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.store.formasPagamentos, (item, i) => {\n    return _openBlock(), _createElementBlock(\"tbody\", {\n      key: item.name,\n      role: \"rowgroup\"\n    }, [_createElementVNode(\"tr\", _hoisted_8, [_createElementVNode(\"td\", _hoisted_9, _toDisplayString(item.ID), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_10, _toDisplayString(item.DESCRICAO), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_11, _toDisplayString($setup.formataDinheiro($setup.somaValor($setup.store.itensRelVendas.filter(f => f.FORMA_PGTO == item.ID && f.TIPO_VENDA == 'NORMAL').map(x => x.VLR)))), 1\n    /* TEXT */\n    ), _hoisted_12])]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))]), _createElementVNode(\"div\", _hoisted_13, \" Total: \" + _toDisplayString($setup.formataDinheiro($setup.somaValor($setup.store.itensRelVendas.filter(f => f.TIPO_VENDA == 'NORMAL').map(x => x.VLR)))), 1\n  /* TEXT */\n  )])) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"mappings":"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","names":["style","_createElementVNode","role","class","id","scope","_createElementBlock","_hoisted_2","_createVNode","$setup","filtro","dataInicial","dataFinal","onClick","editando","_hoisted_7","_Fragment","_renderList","formasPagamentos","item","i","key","name","_toDisplayString","ID","DESCRICAO","itensRelVendas","filter","f","FORMA_PGTO","TIPO_VENDA","map","x","VLR","_hoisted_12"],"sourceRoot":"","sources":["/home/renato/projetos/pdvsmart/src/views/caixa/Caixa.vue"],"sourcesContent":["<template>\n <div style=\"margin-top: -90px;\">\n        <div style=\"font-size: 35px;\">\n            Fechamento Caixa\n        </div> \n \n    <div style=\"display: flex;  \">\n        <div  >\n            <Filtros /> \n        </div> \n        <div    v-if=\"store.filtro.dataInicial && store.filtro.dataFinal\"\n                style=\"margin-top: 17px;\">\n            <div style=\"background-color: rgb(153, 193, 134);\n                    margin-top: 35px;\n                    height: 35px;\n                    \"\n                class=\"btn btn-primary mt-3\"\n                @click=\"getVendas(tomorrow(store.filtro.dataInicial),tomorrow(store.filtro.dataFinal))\"\n                        >\n                buscar\n            </div>\n        </div> \n        \n        \n    </div>\n\n    <div v-if=\"!store.editando\"\n    style=\"padding: 10px 45px 0px 0px; width: 500px;\">\n    \n        <table style=\"background-color: white;\" role=\"table\" aria-busy=\"false\" aria-colcount=\"5\" class=\"table b-table table-hover\" id=\"__BVID__310\">\n                <thead role=\"rowgroup\" class=\"\">\n                    <tr role=\"row\" class=\"\">\n                        <th role=\"columnheader\" scope=\"col\" aria-colindex=\"1\" class=\"\"><div>#</div></th>\n                        <th role=\"columnheader\" scope=\"col\" aria-colindex=\"2\" class=\"\"><div>TIPO</div></th>\n                        <th role=\"columnheader\" scope=\"col\" aria-colindex=\"3\" class=\"\" style=\"text-align: center;\"><div>R$</div></th> \n                    </tr>\n                </thead> \n                <tbody v-for=\"(item, i) in store.formasPagamentos\" :key=\"item.name\" role=\"rowgroup\">\n                    <tr role=\"row\" class=\"\">\n                        <td aria-colindex=\"1\" role=\"cell\" class=\"\">{{ item.ID }}</td>\n                        <td aria-colindex=\"2\" role=\"cell\" class=\"\">{{ item.DESCRICAO }}</td>\n                        <td aria-colindex=\"3\" role=\"cell\" style=\"text-align: right;\">{{ formataDinheiro(somaValor(store.itensRelVendas.filter(f => f.FORMA_PGTO==item.ID && f.TIPO_VENDA=='NORMAL').map(x => x.VLR)))}}</td> \n                        <td>\n                    </td>                       \n                    </tr>\n\n                </tbody>\n            </table>\n            <div style=\"text-align: right; font-size: 20px; color: blue;\">\n                Total: {{ formataDinheiro(somaValor(store.itensRelVendas.filter(f => f.TIPO_VENDA=='NORMAL').map(x => x.VLR))) }}\n            </div> \n    </div>  \n</div>\n\n\n</template>\n\n<script setup>\n    import Progress from '@/components/Progress.vue';\n    import {indexStore,useUserStore} from '../../store/indexStore' \n    import { onMounted, ref } from 'vue';\n    import axios from 'axios'\n    import { useMeta } from '@/composables/use-meta';\n    import Filtros from './Filtros.vue'\n    useMeta({ title: 'Multiple Tables' });\n    const store = indexStore();\n    const storeLogin = useUserStore();\n    const code_arr = ref([]); \n\n \n  onMounted(() => {\n        bind_data();\n    });\n\n    const bind_data = async  () => { \n\n       store.formasPagamentos = []\n       const getFormasPgto = ()=> {\n                let data = JSON.stringify({\n            \"SCHEMA\": storeLogin.empresas?.schema \n            });\n\n            let config = {\n            method: 'post',\n            maxBodyLength: Infinity,\n            url: store.baseApiHTTPS+'/GetFormapagamento',\n            headers: { \n                'Content-Type': 'application/json'\n            },\n            data : data\n            };\n\n            axios.request(config)\n            .then((response) => { \n            response.data.map(x=> {\n                    const itens ={\n                        ID: x.id,\n                        DESCRICAO: x.descricao,\n                        PERCENTUAL: x.taxa         \n                }\n                store.formasPagamentos.push(itens)\n                }) \n            })\n            .catch((error) => {\n            console.log(error);\n            });\n            }\n\n            getFormasPgto()\n        store.recursos.progress = false\n\n    }\n\n    function getVendas(dataIni, dataFim){\n        store.itensRelVendas = [] \n        let data = JSON.stringify({\n        \"DATAINI\": dataIni,\n        \"DATAFIM\": dataFim,\n        \"SCHEMA\": storeLogin.empresas?.schema \n        });\n\n        let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS+'/periodovendas',\n        headers: { \n            'Content-Type': 'application/json'\n        },\n        data : data\n        };\n\n        axios.request(config)\n        .then((response) => {\n            response.data.filter(f => f.tipo_venda=='NORMAL').map(x =>{\n                const dados = { \n                    ID: x.id,\n                    DATA: x.data,\n                    CATGO: x.categoria,\n                    PRODUTO: x.cod_produto,\n                    NOME: x.nome,\n                    QTDE: x.qtde,\n                    NOME: x.nome, \n                    VLR: x.valor,\n                    CUSTO: x.custo,\n                    LUCRO: arredonda(x.lucro,2),\n                    PERC_LUCRO: arredonda(x.perc_lucro,2),\n                    FORMA_PGTO: x.forma_pgto,\n                    MES: x.mes,\n                    TIPO_VENDA: x.tipo_venda\n                } \n                store.itensRelVendas.push(dados)\n            })\n        })\n        .catch((error) => {\n        console.log(error);\n        }); \n    }\n\n    var arredonda = function(numero, casasDecimais) {   \n    casasDecimais = typeof casasDecimais !== 'undefined' ?  casasDecimais : 0;\n    numero = typeof numero !== 'undefined' ?  numero : 0;\n    return +(Math.floor(numero + ('e+' + casasDecimais)) + ('e-' + casasDecimais));\n    };\n\n    function somaValor(array) { \n            var arr =  array     \n            var sum = 0; \n            for(var i =0;i<arr.length;i++){ \n              sum+=arr[i]; \n            }  \n             \n            return sum\n          }\n\n   function formataDinheiro(item) {\n             let venda = item;\n             if (!!venda && venda.toString().includes(\",\")) {\n               venda = venda.toString().replace(\",\", \".\");\n             }\n             return parseFloat(venda)\n               .toFixed(2)\n               .replace(\".\", \",\")\n               .replace(/(\\d)(?=(\\d{3})+\\,)/g, \"$1.\");\n        }\n\n   function dataFormatada(d){ \n        var data =  new Date(d),\n            dia  = data.getDate().toString(),\n            diaF = (dia.length == 1) ? '0'+dia : dia,\n            mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.\n            mesF = (mes.length == 1) ? '0'+mes : mes,\n            anoF = data.getFullYear();\n        return diaF+\"/\"+mesF+\"/\"+anoF;\n        }\n\n function tomorrow  (dt)  {\n  \n  // Creating the date instance\n  let d = new Date(dt);\n\n  // Adding one date to the present date\n  d.setDate(d.getDate() + 1);\n\n  let year = d.getFullYear()\n  let month = String(d.getMonth() + 1)\n  let day = String(d.getDate())\n  let mes = null\n\n  // Adding leading 0 if the day or month\n  // is one digit value\n  month = month.length == 1 ? \n      month.padStart('2', '0') : month;\n\n   //   if(month == '01'){ mes = 'Jan' }\n   //   if(month == '02'){ mes = 'Feb' }\n   //   if(month == '03'){ mes = 'Mar' }\n   //   if(month == '04'){ mes = 'Apr' }\n   //   if(month == '05'){ mes = 'May' }\n   //   if(month == '06'){ mes = 'Jun' }\n   //   if(month == '07'){ mes = 'Jul' }\n   //   if(month == '08'){ mes = 'Aug' }\n   //   if(month == '09'){ mes = 'Sept' }\n   //   if(month == '10'){ mes = 'Oct' }\n   //   if(month == '11'){ mes = 'Nov' }\n   //  if(month == '12'){ mes = 'Dec' }        \n\n\n  day = day.length == 1 ? \n      day.padStart('2', '0') : day;\n\n  // Printing the present date \n  return(`${day}/${month}/${year}`);\n  }\n    \n\n     \n    \n</script>"]},"metadata":{},"sourceType":"module"}