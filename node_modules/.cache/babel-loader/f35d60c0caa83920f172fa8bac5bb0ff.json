{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport Progress from '@/components/Progress.vue';\nimport { indexStore, useUserStore } from '../../store/indexStore';\nimport { onMounted, ref } from 'vue';\nimport axios from 'axios';\nimport { useMeta } from '@/composables/use-meta';\nexport default {\n  __name: 'vendasRel',\n\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n\n    useMeta({\n      title: 'Multiple Tables'\n    });\n    const store = indexStore();\n    const storeLogin = useUserStore();\n    const code_arr = ref([]); //table 1\n\n    store.recursos.progress = true;\n\n    var arredonda = function (numero, casasDecimais) {\n      casasDecimais = typeof casasDecimais !== 'undefined' ? casasDecimais : 0;\n      numero = typeof numero !== 'undefined' ? numero : 0;\n      return +(Math.floor(numero + ('e+' + casasDecimais)) + ('e-' + casasDecimais));\n    };\n\n    function dataAtualFormatada(dataFormat) {\n      var data = dataFormat,\n          dia = data.getDate().toString(),\n          diaF = dia.length == 1 ? '0' + dia : dia,\n          mes = (data.getMonth() + 1).toString(),\n          //+1 pois no getMonth Janeiro começa com zero.\n      mesF = mes.length == 1 ? '0' + mes : mes,\n          anoF = data.getFullYear();\n      return diaF + \"/\" + mesF + \"/\" + anoF;\n    }\n\n    function dataAtualMes(dataFormat) {\n      var data = dataFormat,\n          dia = data.getDate().toString(),\n          diaF = dia.length == 1 ? '0' + dia : dia,\n          mes = (data.getMonth() + 1).toString(),\n          //+1 pois no getMonth Janeiro começa com zero.\n      mesF = mes.length == 1 ? '0' + mes : mes,\n          anoF = data.getFullYear();\n      return mesF + \"/\" + anoF;\n    }\n\n    const end = new Date();\n    end.setHours(23, 59, 59, 999);\n    end.getTime();\n\n    function formataDinheiro(item) {\n      let venda = item;\n\n      if (!!venda && venda.toString().includes(\",\")) {\n        venda = venda.toString().replace(\",\", \".\");\n      }\n\n      return parseFloat(venda).toFixed(2).replace(\".\", \",\").replace(/(\\d)(?=(\\d{3})+\\,)/g, \"$1.\");\n    }\n\n    function vendasHoje(dtfilter) {\n      var arr = store.itensRelVendas.filter(f => f.DATA == dataAtualFormatada(new Date()) && f.TIPO_VENDA == 'NORMAL');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].VLR;\n      }\n\n      store.vendasHoje = sum;\n      return formataDinheiro(sum);\n    }\n\n    function lucroHoje(dtfilter) {\n      var arr = store.itensRelVendas.filter(f => f.DATA == dataAtualFormatada(new Date()) && f.TIPO_VENDA == 'NORMAL');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].LUCRO;\n      }\n\n      store.lucroHoje = sum;\n      return formataDinheiro(sum);\n    }\n\n    function totalMes(dtfilter) {\n      var arr = store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.TIPO_VENDA == 'NORMAL');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].VLR;\n      }\n\n      store.vendasMes = sum;\n      return formataDinheiro(sum);\n    }\n\n    function lucroMes(dtfilter) {\n      var arr = store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.TIPO_VENDA == 'NORMAL');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].LUCRO;\n      }\n\n      store.lucroMes = sum;\n      return formataDinheiro(sum);\n    }\n\n    function consumoMes(dtfilter) {\n      var arr = store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.TIPO_VENDA == 'CONSUMO-INTERNO');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].CUSTO;\n      }\n\n      return formataDinheiro(sum);\n    }\n\n    function VendasCategoriaDiario(c) {\n      var arr = store.itensRelVendas.filter(f => f.DATA == dataAtualFormatada(new Date()) && f.CATGO == c && f.TIPO_VENDA == 'NORMAL');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].VLR;\n      }\n\n      return formataDinheiro(sum);\n    }\n\n    function VendasCategoriaMes(c) {\n      var arr = store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.CATGO == c && f.TIPO_VENDA == 'NORMAL');\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i].VLR;\n      }\n\n      return formataDinheiro(sum);\n    }\n\n    function percHoje() {\n      let lucro = lucroHoje(); // vendasHoje()\n\n      var soma = lucro * 100;\n      return soma;\n    } //table 2\n\n\n    const columns1 = ref(['ID', 'DATA', 'CATGO', 'PRODUTO', 'NOME', 'QTDE', 'VLR', 'CUSTO', 'LUCRO', 'PERC_LUCRO', 'FORMA_PGTO']);\n    const items1 = store.itensRelVendas;\n    const table_option1 = ref({\n      perPage: 10,\n      perPageValues: [5, 10, 20, 50],\n      skin: 'table ',\n      columnsClasses: {\n        actions: 'actions text-center'\n      },\n      sortable: [],\n      pagination: {\n        nav: 'scroll',\n        chunk: 5\n      },\n      texts: {\n        count: 'Showing {from} to {to} of {count}',\n        filter: '',\n        filterPlaceholder: 'Search...',\n        limit: 'Results:'\n      },\n      sortable: ['ID', 'DATA', 'CATGO', 'PRODUTO', 'NOME', 'QTDE', 'VLR', 'CUSTO', 'LUCRO', 'PERC_LUCRO', 'FORMA_PGTO'],\n      sortIcon: {\n        base: 'sort-icon-none',\n        up: 'sort-icon-asc',\n        down: 'sort-icon-desc'\n      },\n      resizableColumns: false\n    });\n    onMounted(() => {\n      bind_data();\n    });\n\n    const bind_data = async () => {\n      store.mesSelecionado = '01/2024';\n      store.itensRelVendas = [];\n      let data = JSON.stringify({\n        \"SCHEMA\": storeLogin.empresas?.schema,\n        \"MES\": store.mesSelecionado\n      });\n      let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS + '/relvendas',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        data: data\n      };\n      axios.request(config).then(response => {\n        response.data.map(x => {\n          const dados = {\n            ID: x.id,\n            DATA: x.data,\n            CATGO: x.categoria,\n            PRODUTO: x.cod_produto,\n            NOME: x.nome,\n            QTDE: x.qtde,\n            NOME: x.nome,\n            VLR: x.valor,\n            CUSTO: x.custo,\n            LUCRO: arredonda(x.lucro, 2),\n            PERC_LUCRO: arredonda(x.perc_lucro, 2),\n            FORMA_PGTO: x.forma_pgto,\n            MES: x.mes,\n            TIPO_VENDA: x.tipo_venda\n          };\n          store.itensRelVendas.push(dados);\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n      store.itensCategoria = [];\n\n      const getCagetorias = () => {\n        let data = JSON.stringify({\n          \"SCHEMA\": storeLogin.empresas?.schema\n        });\n        let config = {\n          method: 'post',\n          maxBodyLength: Infinity,\n          url: store.baseApiHTTPS + '/getCategorias',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          data: data\n        };\n        axios.request(config).then(response => {\n          response.data.map(x => {\n            const itens = {\n              ID: x.id,\n              DESCRICAO: x.descricao\n            };\n            store.itensCategoria.push(itens);\n          });\n          store.recursos.progress = false;\n        }).catch(error => {\n          console.log(error);\n        });\n      };\n\n      getCagetorias();\n    }; //table 2\n\n\n    const view_row1 = item => {\n      alert('ID: ' + item1.value.ID + ', Name: ' + item1.value.NOMENCLATURA);\n    };\n\n    store.displayVendasCategoria = 'Diario';\n    const __returned__ = {\n      store,\n      storeLogin,\n      code_arr,\n\n      get arredonda() {\n        return arredonda;\n      },\n\n      set arredonda(v) {\n        arredonda = v;\n      },\n\n      dataAtualFormatada,\n      dataAtualMes,\n      end,\n      formataDinheiro,\n      vendasHoje,\n      lucroHoje,\n      totalMes,\n      lucroMes,\n      consumoMes,\n      VendasCategoriaDiario,\n      VendasCategoriaMes,\n      percHoje,\n      columns1,\n      items1,\n      table_option1,\n      bind_data,\n      view_row1,\n      Progress,\n\n      get indexStore() {\n        return indexStore;\n      },\n\n      get useUserStore() {\n        return useUserStore;\n      },\n\n      onMounted,\n      ref,\n\n      get axios() {\n        return axios;\n      },\n\n      get useMeta() {\n        return useMeta;\n      }\n\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["Progress","indexStore","useUserStore","onMounted","ref","axios","useMeta","title","store","storeLogin","code_arr","recursos","progress","arredonda","numero","casasDecimais","Math","floor","dataAtualFormatada","dataFormat","data","dia","getDate","toString","diaF","length","mes","getMonth","mesF","anoF","getFullYear","dataAtualMes","end","Date","setHours","getTime","formataDinheiro","item","venda","includes","replace","parseFloat","toFixed","vendasHoje","dtfilter","arr","itensRelVendas","filter","f","DATA","TIPO_VENDA","sum","i","VLR","lucroHoje","LUCRO","totalMes","MES","vendasMes","lucroMes","consumoMes","CUSTO","VendasCategoriaDiario","c","CATGO","VendasCategoriaMes","percHoje","lucro","soma","columns1","items1","table_option1","perPage","perPageValues","skin","columnsClasses","actions","sortable","pagination","nav","chunk","texts","count","filterPlaceholder","limit","sortIcon","base","up","down","resizableColumns","bind_data","mesSelecionado","JSON","stringify","empresas","schema","config","method","maxBodyLength","Infinity","url","baseApiHTTPS","headers","request","then","response","map","x","dados","ID","id","categoria","PRODUTO","cod_produto","NOME","nome","QTDE","qtde","valor","custo","PERC_LUCRO","perc_lucro","FORMA_PGTO","forma_pgto","tipo_venda","push","catch","error","console","log","itensCategoria","getCagetorias","itens","DESCRICAO","descricao","view_row1","alert","item1","value","NOMENCLATURA","displayVendasCategoria"],"sources":["/home/renato/projetos/pdvsmart/src/views/vendasRel/vendasRel.vue"],"sourcesContent":["<template>\n    <div class=\"layout-px-spacing\" style=\"margin-top: 0px; margin-left: -20px;\">\n        <div style=\"display: flex;\">        \n        <div>\n            <h2 class=\"text-2xl font-medium mx-2\" data-testid=\"statements-title-txt\">Ticket Médio de Vendas</h2>\n        </div>\n        <div>\n        <input type=\"text\" v-model=\"store.mesSelecionado\">\n        </div>\n        {{ store.mesSelecionado }}\n        <div>\n         <BUTTON></BUTTON>\n        </div>\n    </div>             \n \n\n    \n\n \n<Progress v-if=\"store.recursos.progress\" />\n \n\n<div v-if=\"!store.recursos.progress\">\n    <div  style=\"display: flex;\n        flex-wrap: wrap; \n                        margin: 15px 0px 15px 0px;\n                    \">\n\n                    <div class=\"card\" style=\"padding: 10px; width: 200px;height: 120px;border-radius: 10px;\n                                    align-items: center; margin: 0px 20px 15px 0px;\">\n            <span style=\"font-size: 25px; color: black;\">\n                Total Mês\n            </span> \n            <div style=\"font-size: 25px; color: forestgreen\">\n                R$ {{ totalMes()}}\n            </div>\n         </div>\n\n         <div class=\"card\" style=\"padding: 10px;  width: 200px; height: 120px; \n                                 border-radius: 10px; align-items: center;\n                                 margin: 0px 20px 15px 0px;\n                                 background-color: ;\n                                 \">\n            <span style=\"font-size: 22px; color: black; \">\n                Lucro Mês\n            </span> \n            <div style=\"font-size: 22px; color: forestgreen\">\n                R$ {{ lucroMes()}}\n                <span style=\"font-size: 15px; color: blue;\">{{formataDinheiro(store.lucroMes * 100 / store.vendasMes)}}%</span> \n            </div>\n            \n         </div> \n\n         <div class=\"card\" style=\"padding: 10px;  width: 200px; height: 120px; \n                                 border-radius: 10px; align-items: center;\n                                 margin: 0px 20px 15px 0px;\n                                 background-color: ;\n                                 \">\n            <span style=\"font-size: 25px; color: black; \">\n                Consumo \n            </span> \n            <div style=\"font-size: 25px; color: rgb(206, 19, 44)\">\n               - R$ {{ consumoMes()}}\n             \n            </div>\n            \n         </div> \n\n         <div class=\"card\" style=\"padding: 10px;  width: 200px; height: 120px; \n                                 border-radius: 10px; align-items: center;\n                                 margin: 0px 20px 15px 0px;\n                                 background-color: ;\n                                 \">\n            <span style=\"font-size: 25px; color: black; \">\n                Total do Dia\n            </span> \n            <div style=\"font-size: 25px; color: forestgreen\">\n                R$ {{ vendasHoje()}}\n            </div>\n            \n         </div> \n\n         <div class=\"card\" style=\"padding: 10px; width: 200px;height: \n                                120px;border-radius: 10px; align-items: center;\n                                margin: 0px 20px 15px 0px;\n                                \n                                \">\n            <span style=\"font-size: 25px; color: black;\">\n                Lucro do Dia\n            </span> \n             \n            <div style=\"font-size: 25px; color: forestgreen\">\n                R$ {{ lucroHoje()}} \n                <span style=\"font-size: 15px; color: blue;\">{{formataDinheiro(store.lucroHoje * 100 / store.vendasHoje)}}%</span> \n            </div>\n           \n         </div>\n       \n         <select class=\"form-control\" style=\"height: 44px; width: 130px;\" v-model=\"store.displayVendasCategoria\">\n            <option>Esconder</option>  \n            <option>Diario</option>\n            <option>Mensal</option>                                                     \n        </select>\n         </div> \n\n<div v-if=\"store.displayVendasCategoria == 'Diario'\"   style=\"display: flex;\n        flex-wrap: wrap; \n                        margin: 15px 0px 15px 0px;\n                    \">\n                  \n   <div v-for=\"c,index in store.itensCategoria\" :key=\"index\"  style=\"display: inline-flex;\">\n        <div class=\"card\" style=\"padding: 5px; width: 120px;height: 80px;border-radius: 10px;\n                                    align-items: center; margin: 0px 20px 15px 0px; \">\n            <span style=\"font-size:20px; color: black;\">\n                {{ c.DESCRICAO }}\n            </span> \n            <div style=\"font-size: 25px; color: forestgreen\">\n                  {{ VendasCategoriaDiario(c.DESCRICAO) }}\n            </div>\n         </div>\n    </div>\n    \n</div>\n\n \n<div v-if=\"store.displayVendasCategoria == 'Mensal'\" style=\"display: flex;\n        flex-wrap: wrap; \n                        margin: 15px 0px 15px 0px;\n                    \">\n                  \n            <div v-for=\"c,index in store.itensCategoria\" :key=\"index\"  style=\"display: inline-flex;\">\n            <div class=\"card\" style=\"padding: 5px; width: 120px;height: 80px;border-radius: 10px;\n                                    align-items: center; margin: 0px 20px 15px 0px; \">\n            <span style=\"font-size:20px; color: black;\">\n                {{ c.DESCRICAO }}\n            </span> \n            <div style=\"font-size: 25px; color: forestgreen\">\n                  {{ VendasCategoriaMes(c.DESCRICAO) }}\n            </div>\n         </div>\n    </div>\n</div>\n  \n        \n        <div v-if=\"!store.editando\">\n            <div  >\n              \n                <div class=\"panel br-0 p-0 mt-0\" >\n                    <div class=\"custom-table\">\n                        <v-client-table :data=\"store.itensRelVendas\" :columns=\"columns1\" :options=\"table_option1\">\n                        \n                            <template #progress=\"props\">\n                                <div class=\"progress\">\n                                    <div\n                                        role=\"progressbar\"\n                                        aria-valuemin=\"0\"\n                                        :aria-valuemax=\"props.row.progress.count\"\n                                        aria-valuenow=\"100\"\n                                        class=\"progress-bar\"\n                                        :class=\"'bg-' + props.row.progress.class\"\n                                        :style=\"{ width: props.row.progress.count + '%' }\"\n                                    ></div>\n                                </div>\n                            </template>\n                     \n                        </v-client-table>\n                    </div>\n                </div>\n            </div>\n        </div>\n</div>\n       \n    </div>\n</template>\n\n<script setup>\n    import Progress from '@/components/Progress.vue';\n    import {indexStore, useUserStore} from '../../store/indexStore' \n    import { onMounted, ref } from 'vue';\n    import axios from 'axios'\n    import { useMeta } from '@/composables/use-meta';\n    useMeta({ title: 'Multiple Tables' });\n    const store      = indexStore(); \n    const storeLogin = useUserStore();\n    const code_arr = ref([]);\n    //table 1\n   \n    store.recursos.progress = true\n\n    var arredonda = function(numero, casasDecimais) {   \n    casasDecimais = typeof casasDecimais !== 'undefined' ?  casasDecimais : 0;\n    numero = typeof numero !== 'undefined' ?  numero : 0;\n    return +(Math.floor(numero + ('e+' + casasDecimais)) + ('e-' + casasDecimais));\n    };\n\n\n    function dataAtualFormatada(dataFormat){\n    var data = dataFormat,\n        dia  = data.getDate().toString(),\n        diaF = (dia.length == 1) ? '0'+dia : dia,\n        mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.\n        mesF = (mes.length == 1) ? '0'+mes : mes,\n        anoF = data.getFullYear();\n    return diaF+\"/\"+mesF+\"/\"+anoF;\n    } \n\n    function dataAtualMes(dataFormat){\n    var data = dataFormat,\n        dia  = data.getDate().toString(),\n        diaF = (dia.length == 1) ? '0'+dia : dia,\n        mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.\n        mesF = (mes.length == 1) ? '0'+mes : mes,\n        anoF = data.getFullYear();\n    return mesF+\"/\"+anoF;\n    } \n    \n        const end=new Date()\n        end.setHours(23,59,59,999)\n        end.getTime()\n \n\n    function formataDinheiro(item) {\n         let venda = item;\n         if (!!venda && venda.toString().includes(\",\")) {\n           venda = venda.toString().replace(\",\", \".\");\n         }\n         return parseFloat(venda)\n           .toFixed(2)\n           .replace(\".\", \",\")\n           .replace(/(\\d)(?=(\\d{3})+\\,)/g, \"$1.\");\n    }\n\n    function vendasHoje(dtfilter) { \n        var arr =  store.itensRelVendas.filter(f => f.DATA==dataAtualFormatada(new Date()) && f.TIPO_VENDA=='NORMAL') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].VLR; \n        }  \n        store.vendasHoje = sum\n        return formataDinheiro(sum)\n      }\n   \n      function lucroHoje(dtfilter) { \n        var arr =  store.itensRelVendas.filter(f => f.DATA==dataAtualFormatada(new Date()) && f.TIPO_VENDA=='NORMAL') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].LUCRO; \n        }  \n        store.lucroHoje = sum\n        return formataDinheiro(sum)\n      }\n \n      function totalMes(dtfilter) { \n        var arr =  store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.TIPO_VENDA=='NORMAL') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].VLR; \n        }  \n        store.vendasMes = sum\n        return formataDinheiro(sum)\n      }\n\n      function lucroMes(dtfilter) { \n        var arr =  store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.TIPO_VENDA=='NORMAL') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].LUCRO; \n        }  \n        store.lucroMes = sum\n        return formataDinheiro(sum)\n      }\n\n      function consumoMes(dtfilter) { \n        var arr =  store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.TIPO_VENDA=='CONSUMO-INTERNO') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].CUSTO; \n        }  \n         \n        return formataDinheiro(sum)\n      }\n\n\n      function VendasCategoriaDiario(c) {\n     \n\n        var arr =  store.itensRelVendas.filter(f => f.DATA==dataAtualFormatada(new Date()) && f.CATGO==c && f.TIPO_VENDA=='NORMAL') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].VLR; \n        }  \n        return formataDinheiro(sum)\n         \n      }\n\n      function VendasCategoriaMes(c) { \n\n        var arr =  store.itensRelVendas.filter(f => f.MES == dataAtualMes(new Date()) && f.CATGO==c && f.TIPO_VENDA=='NORMAL') \n        var sum = 0; \n        for(var i =0;i<arr.length;i++){ \n          sum+=arr[i].VLR; \n        }  \n        return formataDinheiro(sum)         \n      }\n   \n      function percHoje () {\n            let lucro =  lucroHoje()   // vendasHoje()\n            var soma = (lucro * 100)\n            return soma\n      }\n     \n    \n\n    //table 2\n    const columns1 = ref( ['ID','DATA','CATGO','PRODUTO','NOME','QTDE','VLR','CUSTO','LUCRO','PERC_LUCRO','FORMA_PGTO' ]);\n    const items1 = store.itensRelVendas;\n    const table_option1 = ref({\n        perPage: 10,\n        perPageValues: [5, 10, 20, 50],\n        skin: 'table ',\n        columnsClasses: { actions: 'actions text-center' },\n        sortable: [],\n        pagination: { nav: 'scroll', chunk: 5 },\n        texts: {\n            count: 'Showing {from} to {to} of {count}',\n            filter: '',\n            filterPlaceholder: 'Search...',\n            limit: 'Results:',\n        },\n        sortable: ['ID','DATA','CATGO','PRODUTO','NOME','QTDE','VLR','CUSTO','LUCRO','PERC_LUCRO','FORMA_PGTO' ],\n        sortIcon: {\n            base: 'sort-icon-none',\n            up: 'sort-icon-asc',\n            down: 'sort-icon-desc',\n        },\n        resizableColumns: false,\n    });\n\n    onMounted(() => {\n        bind_data();\n    });\n\n    const bind_data = async  () => {\n        store.mesSelecionado = '01/2024'\n        store.itensRelVendas = []\n\n        let data = JSON.stringify({\n            \"SCHEMA\":   storeLogin.empresas?.schema,\n            \"MES\":         store.mesSelecionado\n            });\n\n            let config = {\n            method: 'post',\n            maxBodyLength: Infinity,\n            url: store.baseApiHTTPS+'/relvendas',\n            headers: { \n                'Content-Type': 'application/json'\n            },\n            data : data\n            };\n\n            axios.request(config)\n            .then((response) => { \n            response.data.map(x =>{\n                const dados = { \n                    ID: x.id,\n                    DATA: x.data,\n                    CATGO: x.categoria,\n                    PRODUTO: x.cod_produto,\n                    NOME: x.nome,\n                    QTDE: x.qtde,\n                    NOME: x.nome, \n                    VLR: x.valor,\n                    CUSTO: x.custo,\n                    LUCRO: arredonda(x.lucro,2),\n                    PERC_LUCRO: arredonda(x.perc_lucro,2),\n                    FORMA_PGTO: x.forma_pgto,\n                    MES: x.mes,\n                    TIPO_VENDA: x.tipo_venda\n                }\n                store.itensRelVendas.push(dados)\n            })\n            })\n            .catch((error) => {\n            console.log(error);\n            });\n \n        \n\n       store.itensCategoria = []\n\n       const getCagetorias = () => {\n        let data = JSON.stringify({\n        \"SCHEMA\": storeLogin.empresas?.schema \n        });\n\n        let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS+'/getCategorias',\n        headers: { \n            'Content-Type': 'application/json'\n        },\n        data : data\n        };\n\n        axios.request(config)\n        .then((response) => { \n        response.data.map(x=> {\n                const itens ={\n                    ID: x.id, \n                    DESCRICAO: x.descricao\n            }\n            store.itensCategoria.push(itens)\n            }) \n                store.recursos.progress = false\n        })\n        .catch((error) => {\n        console.log(error);\n        });\n       }\n\n       \n       getCagetorias()\n        \n       \n\n    }\n    //table 2\n    const view_row1 = (item) => {\n        alert('ID: ' + item1.value.ID + ', Name: ' + item1.value.NOMENCLATURA);\n    };\n \n    store.displayVendasCategoria = 'Diario'\n\n\n</script>\n\n<style>\n</style>\n"]},"metadata":{},"sourceType":"module"}