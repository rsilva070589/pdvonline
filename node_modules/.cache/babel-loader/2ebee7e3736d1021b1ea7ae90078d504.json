{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport { createElementVNode as _createElementVNode, createVNode as _createVNode, unref as _unref, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"margin-top\": \"0px\"\n  }\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"div\", {\n  style: {\n    \"font-size\": \"35px\"\n  }\n}, \" Fechamento Caixa \", -1);\n\nconst _hoisted_3 = {\n  style: {\n    \"display\": \"flex\"\n  }\n};\nconst _hoisted_4 = {\n  key: 0,\n  style: {\n    \"margin-top\": \"17px\"\n  }\n};\nconst _hoisted_5 = {\n  key: 0,\n  style: {\n    \"padding\": \"10px 45px 0px 0px\",\n    \"width\": \"500px\"\n  }\n};\nconst _hoisted_6 = {\n  style: {\n    \"background-color\": \"white\"\n  },\n  role: \"table\",\n  \"aria-busy\": \"false\",\n  \"aria-colcount\": \"5\",\n  class: \"table b-table table-hover\",\n  id: \"__BVID__310\"\n};\n\nconst _hoisted_7 = /*#__PURE__*/_createElementVNode(\"thead\", {\n  role: \"rowgroup\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"tr\", {\n  role: \"row\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"th\", {\n  role: \"columnheader\",\n  scope: \"col\",\n  \"aria-colindex\": \"1\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"div\", null, \"#\")]), /*#__PURE__*/_createElementVNode(\"th\", {\n  role: \"columnheader\",\n  scope: \"col\",\n  \"aria-colindex\": \"2\",\n  class: \"\"\n}, [/*#__PURE__*/_createElementVNode(\"div\", null, \"TIPO\")]), /*#__PURE__*/_createElementVNode(\"th\", {\n  role: \"columnheader\",\n  scope: \"col\",\n  \"aria-colindex\": \"3\",\n  class: \"\",\n  style: {\n    \"text-align\": \"center\"\n  }\n}, [/*#__PURE__*/_createElementVNode(\"div\", null, \"R$\")])])], -1);\n\nconst _hoisted_8 = {\n  role: \"row\",\n  class: \"\"\n};\nconst _hoisted_9 = {\n  \"aria-colindex\": \"1\",\n  role: \"cell\",\n  class: \"\"\n};\nconst _hoisted_10 = {\n  \"aria-colindex\": \"2\",\n  role: \"cell\",\n  class: \"\"\n};\nconst _hoisted_11 = {\n  \"aria-colindex\": \"3\",\n  role: \"cell\",\n  style: {\n    \"text-align\": \"right\"\n  }\n};\n\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"td\", null, null, -1);\n\nconst _hoisted_13 = {\n  style: {\n    \"text-align\": \"right\",\n    \"font-size\": \"20px\",\n    \"color\": \"blue\"\n  }\n};\nimport Progress from '@/components/Progress.vue';\nimport { indexStore, useUserStore } from '../../store/indexStore';\nimport { onMounted, ref } from 'vue';\nimport axios from 'axios';\nimport { useMeta } from '@/composables/use-meta';\nimport Filtros from './Filtros.vue';\nexport default {\n  __name: 'Caixa',\n\n  setup(__props) {\n    useMeta({\n      title: 'Multiple Tables'\n    });\n    const store = indexStore();\n    const storeLogin = useUserStore();\n    const code_arr = ref([]);\n    onMounted(() => {\n      bind_data();\n    });\n\n    const bind_data = async () => {\n      store.formasPagamentos = [];\n\n      const getFormasPgto = () => {\n        let data = JSON.stringify({\n          \"SCHEMA\": storeLogin.empresas?.schema\n        });\n        let config = {\n          method: 'post',\n          maxBodyLength: Infinity,\n          url: store.baseApiHTTPS + '/GetFormapagamento',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          data: data\n        };\n        axios.request(config).then(response => {\n          response.data.map(x => {\n            const itens = {\n              ID: x.id,\n              DESCRICAO: x.descricao,\n              PERCENTUAL: x.taxa\n            };\n            store.formasPagamentos.push(itens);\n          });\n        }).catch(error => {\n          console.log(error);\n        });\n      };\n\n      getFormasPgto();\n      store.recursos.progress = false;\n    };\n\n    function getVendas(dataIni, dataFim) {\n      store.itensRelVendas = [];\n      let data = JSON.stringify({\n        \"DATAINI\": dataIni,\n        \"DATAFIM\": dataFim,\n        \"SCHEMA\": storeLogin.empresas?.schema\n      });\n      let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS + '/periodovendas',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        data: data\n      };\n      axios.request(config).then(response => {\n        response.data.filter(f => f.tipo_venda == 'NORMAL').map(x => {\n          const dados = {\n            ID: x.id,\n            DATA: x.data,\n            CATGO: x.categoria,\n            PRODUTO: x.cod_produto,\n            NOME: x.nome,\n            QTDE: x.qtde,\n            NOME: x.nome,\n            VLR: x.valor,\n            CUSTO: x.custo,\n            LUCRO: arredonda(x.lucro, 2),\n            PERC_LUCRO: arredonda(x.perc_lucro, 2),\n            FORMA_PGTO: x.forma_pgto,\n            MES: x.mes,\n            TIPO_VENDA: x.tipo_venda\n          };\n          store.itensRelVendas.push(dados);\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n\n    var arredonda = function (numero, casasDecimais) {\n      casasDecimais = typeof casasDecimais !== 'undefined' ? casasDecimais : 0;\n      numero = typeof numero !== 'undefined' ? numero : 0;\n      return +(Math.floor(numero + ('e+' + casasDecimais)) + ('e-' + casasDecimais));\n    };\n\n    function somaValor(array) {\n      var arr = array;\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i];\n      }\n\n      return sum;\n    }\n\n    function formataDinheiro(item) {\n      let venda = item;\n\n      if (!!venda && venda.toString().includes(\",\")) {\n        venda = venda.toString().replace(\",\", \".\");\n      }\n\n      return parseFloat(venda).toFixed(2).replace(\".\", \",\").replace(/(\\d)(?=(\\d{3})+\\,)/g, \"$1.\");\n    }\n\n    function dataFormatada(d) {\n      var data = new Date(d),\n          dia = data.getDate().toString(),\n          diaF = dia.length == 1 ? '0' + dia : dia,\n          mes = (data.getMonth() + 1).toString(),\n          //+1 pois no getMonth Janeiro começa com zero.\n      mesF = mes.length == 1 ? '0' + mes : mes,\n          anoF = data.getFullYear();\n      return diaF + \"/\" + mesF + \"/\" + anoF;\n    }\n\n    function tomorrow(dt) {\n      // Creating the date instance\n      let d = new Date(dt); // Adding one date to the present date\n\n      d.setDate(d.getDate() + 1);\n      let year = d.getFullYear();\n      let month = String(d.getMonth() + 1);\n      let day = String(d.getDate());\n      let mes = null; // Adding leading 0 if the day or month\n      // is one digit value\n\n      month = month.length == 1 ? month.padStart('2', '0') : month; //   if(month == '01'){ mes = 'Jan' }\n      //   if(month == '02'){ mes = 'Feb' }\n      //   if(month == '03'){ mes = 'Mar' }\n      //   if(month == '04'){ mes = 'Apr' }\n      //   if(month == '05'){ mes = 'May' }\n      //   if(month == '06'){ mes = 'Jun' }\n      //   if(month == '07'){ mes = 'Jul' }\n      //   if(month == '08'){ mes = 'Aug' }\n      //   if(month == '09'){ mes = 'Sept' }\n      //   if(month == '10'){ mes = 'Oct' }\n      //   if(month == '11'){ mes = 'Nov' }\n      //  if(month == '12'){ mes = 'Dec' }        \n\n      day = day.length == 1 ? day.padStart('2', '0') : day; // Printing the present date \n\n      return `${day}/${month}/${year}`;\n    }\n\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"div\", null, [_createVNode(Filtros)]), _unref(store).filtro.dataInicial && _unref(store).filtro.dataFinal ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", {\n        style: {\n          \"background-color\": \"rgb(153, 193, 134)\",\n          \"margin-top\": \"35px\",\n          \"height\": \"35px\"\n        },\n        class: \"btn btn-primary mt-3\",\n        onClick: _cache[0] || (_cache[0] = $event => getVendas(tomorrow(_unref(store).filtro.dataInicial), tomorrow(_unref(store).filtro.dataFinal)))\n      }, \" buscar \")])) : _createCommentVNode(\"\", true)]), !_unref(store).editando ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"table\", _hoisted_6, [_hoisted_7, (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).formasPagamentos, (item, i) => {\n        return _openBlock(), _createElementBlock(\"tbody\", {\n          key: item.name,\n          role: \"rowgroup\"\n        }, [_createElementVNode(\"tr\", _hoisted_8, [_createElementVNode(\"td\", _hoisted_9, _toDisplayString(item.ID), 1), _createElementVNode(\"td\", _hoisted_10, _toDisplayString(item.DESCRICAO), 1), _createElementVNode(\"td\", _hoisted_11, _toDisplayString(formataDinheiro(somaValor(_unref(store).itensRelVendas.filter(f => f.FORMA_PGTO == item.ID && f.TIPO_VENDA == 'NORMAL').map(x => x.VLR)))), 1), _hoisted_12])]);\n      }), 128))]), _createElementVNode(\"div\", _hoisted_13, \" Total: \" + _toDisplayString(formataDinheiro(somaValor(_unref(store).itensRelVendas.filter(f => f.TIPO_VENDA == 'NORMAL').map(x => x.VLR)))), 1)])) : _createCommentVNode(\"\", true)]);\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["Progress","indexStore","useUserStore","onMounted","ref","axios","useMeta","Filtros","title","store","storeLogin","code_arr","bind_data","formasPagamentos","getFormasPgto","data","JSON","stringify","empresas","schema","config","method","maxBodyLength","Infinity","url","baseApiHTTPS","headers","request","then","response","map","x","itens","ID","id","DESCRICAO","descricao","PERCENTUAL","taxa","push","catch","error","console","log","recursos","progress","getVendas","dataIni","dataFim","itensRelVendas","filter","f","tipo_venda","dados","DATA","CATGO","categoria","PRODUTO","cod_produto","NOME","nome","QTDE","qtde","VLR","valor","CUSTO","custo","LUCRO","arredonda","lucro","PERC_LUCRO","perc_lucro","FORMA_PGTO","forma_pgto","MES","mes","TIPO_VENDA","numero","casasDecimais","Math","floor","somaValor","array","arr","sum","i","length","formataDinheiro","item","venda","toString","includes","replace","parseFloat","toFixed","dataFormatada","d","Date","dia","getDate","diaF","getMonth","mesF","anoF","getFullYear","tomorrow","dt","setDate","year","month","String","day","padStart"],"sources":["/home/renato/projetos/pdvsmart/src/views/caixa/Caixa.vue"],"sourcesContent":["<template>\n <div style=\"margin-top: 0px;\">\n        <div style=\"font-size: 35px;\">\n            Fechamento Caixa\n        </div> \n \n    <div style=\"display: flex;  \">\n        <div  >\n            <Filtros /> \n        </div> \n        <div    v-if=\"store.filtro.dataInicial && store.filtro.dataFinal\"\n                style=\"margin-top: 17px;\">\n            <div style=\"background-color: rgb(153, 193, 134);\n                    margin-top: 35px;\n                    height: 35px;\n                    \"\n                class=\"btn btn-primary mt-3\"\n                @click=\"getVendas(tomorrow(store.filtro.dataInicial),tomorrow(store.filtro.dataFinal))\"\n                        >\n                buscar\n            </div>\n        </div> \n        \n        \n    </div>\n\n    <div v-if=\"!store.editando\"\n    style=\"padding: 10px 45px 0px 0px; width: 500px;\">\n    \n        <table style=\"background-color: white;\" role=\"table\" aria-busy=\"false\" aria-colcount=\"5\" class=\"table b-table table-hover\" id=\"__BVID__310\">\n                <thead role=\"rowgroup\" class=\"\">\n                    <tr role=\"row\" class=\"\">\n                        <th role=\"columnheader\" scope=\"col\" aria-colindex=\"1\" class=\"\"><div>#</div></th>\n                        <th role=\"columnheader\" scope=\"col\" aria-colindex=\"2\" class=\"\"><div>TIPO</div></th>\n                        <th role=\"columnheader\" scope=\"col\" aria-colindex=\"3\" class=\"\" style=\"text-align: center;\"><div>R$</div></th> \n                    </tr>\n                </thead> \n                <tbody v-for=\"(item, i) in store.formasPagamentos\" :key=\"item.name\" role=\"rowgroup\">\n                    <tr role=\"row\" class=\"\">\n                        <td aria-colindex=\"1\" role=\"cell\" class=\"\">{{ item.ID }}</td>\n                        <td aria-colindex=\"2\" role=\"cell\" class=\"\">{{ item.DESCRICAO }}</td>\n                        <td aria-colindex=\"3\" role=\"cell\" style=\"text-align: right;\">{{ formataDinheiro(somaValor(store.itensRelVendas.filter(f => f.FORMA_PGTO==item.ID && f.TIPO_VENDA=='NORMAL').map(x => x.VLR)))}}</td> \n                        <td>\n                    </td>                       \n                    </tr>\n\n                </tbody>\n            </table>\n            <div style=\"text-align: right; font-size: 20px; color: blue;\">\n                Total: {{ formataDinheiro(somaValor(store.itensRelVendas.filter(f => f.TIPO_VENDA=='NORMAL').map(x => x.VLR))) }}\n            </div> \n    </div>  \n</div>\n\n\n</template>\n\n<script setup>\n    import Progress from '@/components/Progress.vue';\n    import {indexStore,useUserStore} from '../../store/indexStore' \n    import { onMounted, ref } from 'vue';\n    import axios from 'axios'\n    import { useMeta } from '@/composables/use-meta';\n    import Filtros from './Filtros.vue'\n    useMeta({ title: 'Multiple Tables' });\n    const store = indexStore();\n    const storeLogin = useUserStore();\n    const code_arr = ref([]); \n\n \n  onMounted(() => {\n        bind_data();\n    });\n\n    const bind_data = async  () => { \n\n       store.formasPagamentos = []\n       const getFormasPgto = ()=> {\n                let data = JSON.stringify({\n            \"SCHEMA\": storeLogin.empresas?.schema \n            });\n\n            let config = {\n            method: 'post',\n            maxBodyLength: Infinity,\n            url: store.baseApiHTTPS+'/GetFormapagamento',\n            headers: { \n                'Content-Type': 'application/json'\n            },\n            data : data\n            };\n\n            axios.request(config)\n            .then((response) => { \n            response.data.map(x=> {\n                    const itens ={\n                        ID: x.id,\n                        DESCRICAO: x.descricao,\n                        PERCENTUAL: x.taxa         \n                }\n                store.formasPagamentos.push(itens)\n                }) \n            })\n            .catch((error) => {\n            console.log(error);\n            });\n            }\n\n            getFormasPgto()\n        store.recursos.progress = false\n\n    }\n\n    function getVendas(dataIni, dataFim){\n        store.itensRelVendas = [] \n        let data = JSON.stringify({\n        \"DATAINI\": dataIni,\n        \"DATAFIM\": dataFim,\n        \"SCHEMA\": storeLogin.empresas?.schema \n        });\n\n        let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS+'/periodovendas',\n        headers: { \n            'Content-Type': 'application/json'\n        },\n        data : data\n        };\n\n        axios.request(config)\n        .then((response) => {\n            response.data.filter(f => f.tipo_venda=='NORMAL').map(x =>{\n                const dados = { \n                    ID: x.id,\n                    DATA: x.data,\n                    CATGO: x.categoria,\n                    PRODUTO: x.cod_produto,\n                    NOME: x.nome,\n                    QTDE: x.qtde,\n                    NOME: x.nome, \n                    VLR: x.valor,\n                    CUSTO: x.custo,\n                    LUCRO: arredonda(x.lucro,2),\n                    PERC_LUCRO: arredonda(x.perc_lucro,2),\n                    FORMA_PGTO: x.forma_pgto,\n                    MES: x.mes,\n                    TIPO_VENDA: x.tipo_venda\n                } \n                store.itensRelVendas.push(dados)\n            })\n        })\n        .catch((error) => {\n        console.log(error);\n        }); \n    }\n\n    var arredonda = function(numero, casasDecimais) {   \n    casasDecimais = typeof casasDecimais !== 'undefined' ?  casasDecimais : 0;\n    numero = typeof numero !== 'undefined' ?  numero : 0;\n    return +(Math.floor(numero + ('e+' + casasDecimais)) + ('e-' + casasDecimais));\n    };\n\n    function somaValor(array) { \n            var arr =  array     \n            var sum = 0; \n            for(var i =0;i<arr.length;i++){ \n              sum+=arr[i]; \n            }  \n             \n            return sum\n          }\n\n   function formataDinheiro(item) {\n             let venda = item;\n             if (!!venda && venda.toString().includes(\",\")) {\n               venda = venda.toString().replace(\",\", \".\");\n             }\n             return parseFloat(venda)\n               .toFixed(2)\n               .replace(\".\", \",\")\n               .replace(/(\\d)(?=(\\d{3})+\\,)/g, \"$1.\");\n        }\n\n   function dataFormatada(d){ \n        var data =  new Date(d),\n            dia  = data.getDate().toString(),\n            diaF = (dia.length == 1) ? '0'+dia : dia,\n            mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.\n            mesF = (mes.length == 1) ? '0'+mes : mes,\n            anoF = data.getFullYear();\n        return diaF+\"/\"+mesF+\"/\"+anoF;\n        }\n\n function tomorrow  (dt)  {\n  \n  // Creating the date instance\n  let d = new Date(dt);\n\n  // Adding one date to the present date\n  d.setDate(d.getDate() + 1);\n\n  let year = d.getFullYear()\n  let month = String(d.getMonth() + 1)\n  let day = String(d.getDate())\n  let mes = null\n\n  // Adding leading 0 if the day or month\n  // is one digit value\n  month = month.length == 1 ? \n      month.padStart('2', '0') : month;\n\n   //   if(month == '01'){ mes = 'Jan' }\n   //   if(month == '02'){ mes = 'Feb' }\n   //   if(month == '03'){ mes = 'Mar' }\n   //   if(month == '04'){ mes = 'Apr' }\n   //   if(month == '05'){ mes = 'May' }\n   //   if(month == '06'){ mes = 'Jun' }\n   //   if(month == '07'){ mes = 'Jul' }\n   //   if(month == '08'){ mes = 'Aug' }\n   //   if(month == '09'){ mes = 'Sept' }\n   //   if(month == '10'){ mes = 'Oct' }\n   //   if(month == '11'){ mes = 'Nov' }\n   //  if(month == '12'){ mes = 'Dec' }        \n\n\n  day = day.length == 1 ? \n      day.padStart('2', '0') : day;\n\n  // Printing the present date \n  return(`${day}/${month}/${year}`);\n  }\n    \n\n     \n    \n</script>"]},"metadata":{},"sourceType":"module"}