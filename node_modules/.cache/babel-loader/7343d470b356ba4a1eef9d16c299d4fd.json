{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport { unref as _unref, toDisplayString as _toDisplayString, vModelText as _vModelText, createElementVNode as _createElementVNode, withDirectives as _withDirectives, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, resolveDirective as _resolveDirective, createTextVNode as _createTextVNode, vModelSelect as _vModelSelect } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"space-between\",\n    \"font-size\": \"40px\"\n  }\n};\nconst _hoisted_2 = {\n  style: {\n    \"padding\": \"5px\",\n    \"margin-left\": \"-25px\",\n    \"max-width\": \"400px\",\n    \"font-size\": \"20px\"\n  }\n};\nconst _hoisted_3 = {\n  class: \"conteudo\",\n  style: {\n    \"height\": \"60.5vh\"\n  }\n};\nconst _hoisted_4 = {\n  key: 0\n};\n\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"img\", {\n  style: {\n    \"width\": \"330px\",\n    \"height\": \"350px\"\n  },\n  src: \"https://cdn-icons-png.flaticon.com/512/8146/8146003.png\",\n  class: \"lazy\",\n  alt: \"\"\n}, null, -1);\n\nconst _hoisted_6 = [_hoisted_5];\nconst _hoisted_7 = [\"onClick\"];\nconst _hoisted_8 = {\n  key: 0,\n  class: \"conteudo\",\n  style: {\n    \"background-color\": \"white\",\n    \"min-width\": \"70%\",\n    \"height\": \"77.0vh\",\n    \"padding-right\": \"0px\"\n  }\n};\nconst _hoisted_9 = {\n  style: {\n    \"font-size\": \"40px\"\n  }\n};\nconst _hoisted_10 = {\n  style: {}\n};\nconst _hoisted_11 = [\"onClick\"];\n\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"polyline\", {\n  points: \"3 6 5 6 21 6\"\n}, null, -1);\n\nconst _hoisted_13 = /*#__PURE__*/_createElementVNode(\"path\", {\n  d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n}, null, -1);\n\nconst _hoisted_14 = /*#__PURE__*/_createElementVNode(\"line\", {\n  x1: \"10\",\n  y1: \"11\",\n  x2: \"10\",\n  y2: \"17\"\n}, null, -1);\n\nconst _hoisted_15 = /*#__PURE__*/_createElementVNode(\"line\", {\n  x1: \"14\",\n  y1: \"11\",\n  x2: \"14\",\n  y2: \"17\"\n}, null, -1);\n\nconst _hoisted_16 = [_hoisted_12, _hoisted_13, _hoisted_14, _hoisted_15];\nconst _hoisted_17 = {\n  style: {\n    \"font-size\": \"30px\"\n  }\n};\nconst _hoisted_18 = [\"value\"];\n\nconst _hoisted_19 = /*#__PURE__*/_createElementVNode(\"button\", null, \"Voltar\", -1);\n\nconst _hoisted_20 = [_hoisted_19];\nconst _hoisted_21 = {\n  key: 2,\n  style: {\n    \"background-color\": \"rgb(0, 132, 255)\",\n    \"color\": \"rgb(3, 0, 0)\",\n    \"padding\": \"15px\",\n    \"text-align\": \"center\",\n    \"display\": \"flex\",\n    \"margin\": \"10px\",\n    \"justify-content\": \"center\",\n    \"font-size\": \"20px\",\n    \"min-width\": \"70%\"\n  }\n};\nconst _hoisted_22 = {\n  style: {\n    \"padding\": \"20px\"\n  }\n};\nconst _hoisted_23 = {\n  style: {\n    \"padding\": \"10px\"\n  }\n};\nconst _hoisted_24 = [\"value\"];\n\nconst _hoisted_25 = /*#__PURE__*/_createElementVNode(\"svg\", {\n  fill: \"#000000\",\n  version: \"1.1\",\n  id: \"Capa_1\",\n  xmlns: \"http://www.w3.org/2000/svg\",\n  \"xmlns:xlink\": \"http://www.w3.org/1999/xlink\",\n  width: \"40px\",\n  height: \"40px\",\n  viewBox: \"0 0 199.405 199.405\",\n  \"xml:space\": \"preserve\"\n}, [/*#__PURE__*/_createElementVNode(\"g\", null, [/*#__PURE__*/_createElementVNode(\"polygon\", {\n  points: \"99.703,199.405 199.405,99.702 99.703,0 71.418,28.285 124.662,81.529 0,81.529 0,117.876 124.662,117.876 \\n\\t\\t71.418,171.12 \\t\"\n})])], -1);\n\nconst _hoisted_26 = [_hoisted_25];\nconst _hoisted_27 = {\n  class: \"conteudo\",\n  style: {\n    \"background-color\": \"white\",\n    \"min-width\": \"30%\",\n    \"width\": \"400px\",\n    \"height\": \"200px\",\n    \"margin-top\": \"20px\",\n    \"padding-right\": \"0px\"\n  }\n};\nconst _hoisted_28 = {\n  style: {\n    \"font-size\": \"20px\"\n  }\n};\nconst _hoisted_29 = {\n  style: {\n    \"font-size\": \"20px\"\n  }\n};\nconst _hoisted_30 = {\n  style: {}\n};\nconst _hoisted_31 = [\"onClick\"];\n\nconst _hoisted_32 = /*#__PURE__*/_createElementVNode(\"polyline\", {\n  points: \"3 6 5 6 21 6\"\n}, null, -1);\n\nconst _hoisted_33 = /*#__PURE__*/_createElementVNode(\"path\", {\n  d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"\n}, null, -1);\n\nconst _hoisted_34 = /*#__PURE__*/_createElementVNode(\"line\", {\n  x1: \"10\",\n  y1: \"11\",\n  x2: \"10\",\n  y2: \"17\"\n}, null, -1);\n\nconst _hoisted_35 = /*#__PURE__*/_createElementVNode(\"line\", {\n  x1: \"14\",\n  y1: \"11\",\n  x2: \"14\",\n  y2: \"17\"\n}, null, -1);\n\nconst _hoisted_36 = [_hoisted_32, _hoisted_33, _hoisted_34, _hoisted_35];\nconst _hoisted_37 = {\n  style: {\n    \"background-color\": \"cornsilk\",\n    \"min-width\": \"30%\"\n  }\n};\nconst _hoisted_38 = {\n  style: {\n    \"background-color\": \"#0866B8\",\n    \"min-width\": \"30%\"\n  }\n};\nconst _hoisted_39 = {\n  key: 0,\n  style: {\n    \"font-size\": \"23px\",\n    \"padding\": \"5px\"\n  }\n};\nconst _hoisted_40 = {\n  key: 1,\n  style: {\n    \"padding\": \"8px\"\n  }\n};\nimport { indexStore, useUserStore } from '../../store/indexStore';\nimport axios from 'axios';\nexport default {\n  __name: 'ListagemProdVenda',\n\n  setup(__props) {\n    const store = indexStore();\n    const storeLogin = useUserStore();\n    store.formasPgtoVenda = [];\n    store.CaixaProdutos.QTDE = 1;\n    store.CaixaProdutos.DESCONTO = 0;\n    store.VendaEnviada = false;\n    store.formaPagamento = false;\n    store.produtos = [];\n    store.produtoSearch = '';\n    const produtos = [];\n    store.tipoVenda = 'NORMAL';\n    store.confirmarVendaTime = true;\n\n    const getProdutos = async () => {\n      let data = JSON.stringify({\n        \"SCHEMA\": storeLogin.empresas?.schema\n      });\n      let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS + '/getProdutos',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        data: data\n      };\n      axios.request(config).then(response => {\n        response.data.map(x => {\n          const itens = {\n            ID: x.id,\n            CATEGORIA: x.categoria,\n            CODIGO_BARRAS: x.codigo_barras,\n            DESCRICAO: x.descricao,\n            FOTO: x.foto,\n            NOME: x.nome,\n            SITUACAO: x.situacao,\n            VALOR: x.valor,\n            VALOR_CUSTO: x.valor_custo,\n            QTDE_ESTOQUE: x.qtde_estoque,\n            ID: x.id\n          };\n          produtos.push(itens);\n          store.produtos.push(itens);\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    getProdutos();\n    store.formasPagamentos = [];\n\n    const getFormasPgto = () => {\n      let data = JSON.stringify({\n        \"SCHEMA\": storeLogin.empresas?.schema\n      });\n      let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS + '/GetFormapagamento',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        data: data\n      };\n      axios.request(config).then(response => {\n        response.data.map(x => {\n          const itens = {\n            ID: x.id,\n            DESCRICAO: x.descricao,\n            PERCENTUAL: x.taxa\n          };\n          store.formasPagamentos.push(itens);\n        });\n      }).catch(error => {\n        console.log(error);\n      });\n    };\n\n    getFormasPgto();\n\n    const deleteItem = index => {\n      console.log(index);\n      store.CaixaProdutos.splice(index, 1);\n      somaCaixa();\n    };\n\n    const deletePgto = index => {\n      console.log(index);\n      store.formasPagamentos.push({\n        ID: store.formasPgtoVenda[index].cod_forma_pgto,\n        DESCRICAO: store.formasPgtoVenda[index].descricao\n      });\n      store.formasPgtoVenda.splice(index, 1);\n    };\n\n    var incluirProduto = codProduto => {\n      console.log(codProduto);\n\n      const ItemSelectCaixa = p => p.CODIGO_BARRAS == codProduto;\n\n      const item = produtos.filter(ItemSelectCaixa);\n      let valorDesconto = store.CaixaProdutos.DESCONTO || 0;\n      console.log(item);\n\n      if (item[0]?.CODIGO_BARRAS == codProduto) {\n        store.CaixaProdutos.push({\n          COD_PRODUTO: codProduto,\n          NOME: item[0]?.NOME,\n          QTDE: store.CaixaProdutos.QTDE,\n          VALOR: item[0]?.VALOR * store.CaixaProdutos.QTDE,\n          DESCONTO: valorDesconto.toString().replace(',', '.'),\n          CUSTO: item[0]?.VALOR_CUSTO * store.CaixaProdutos.QTDE,\n          ID_PRODUTO: item[0].ID || 0\n        });\n        somaCaixa();\n        store.CaixaProdutos.QTDE = 1;\n        store.CaixaProdutos.DESCONTO = 0;\n      }\n    };\n\n    function somaCaixa() {\n      var somarProduto = store.CaixaProdutos.map(p => {\n        return p.VALOR - p.DESCONTO;\n      });\n      let totalProd = 0;\n\n      for (let i in somarProduto) {\n        totalProd += somarProduto[i];\n      }\n\n      store.somaCaixa = totalProd;\n      return totalProd;\n    }\n\n    function somaValor(array) {\n      var arr = array;\n      var sum = 0;\n\n      for (var i = 0; i < arr.length; i++) {\n        sum += arr[i];\n      }\n\n      return sum;\n    }\n\n    function saldoPgto() {\n      store.saldoPgto = somaCaixa() - somaValor(store.formasPgtoVenda.map(x => x.valor));\n    }\n\n    const addVenda = async () => {\n      if (store.CaixaProdutos.length > 0 && store.formaPagamento && store.confirmarVendaTime) {\n        store.confirmarVendaTime = false;\n        var data = {\n          SCHEMA: storeLogin.empresas?.schema,\n          COD_CLIENTE: 999,\n          COD_ENDERECO: 1,\n          VALOR: store.somaCaixa,\n          TROCO: store.vendaCaixa.valorTroco,\n          DESCONTO: store.vendaCaixa.descontos,\n          ITENS: store.CaixaProdutos,\n          FORMA_PGTO: 1,\n          TIPO_VENDA: store.tipoVenda,\n          PGTO: store.formasPgtoVenda\n        };\n        console.log(data);\n        var config = {\n          method: 'post',\n          maxBodyLength: Infinity,\n          url: store.baseApiHTTPS + '/vendas',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          data: data\n        };\n        axios(config).then(function (response) {\n          console.log(JSON.stringify(response.data));\n          store.CaixaProdutos = []; //window.location.href = window.location.href\n\n          store.somaCaixa = 0;\n          store.formaPagamento = false;\n          store.produtoSearch = '';\n          store.CaixaProdutos.QTDE = 1;\n          store.CaixaProdutos.DESCONTO = 0;\n          store.recursos.telaCaixaConfirmar = false;\n          showMessage('venda realizada com sucesso.');\n          store.confirmarVendaTime = true;\n          store.formasPgtoVenda = [];\n          store.vendaCaixa.valorPago = 0;\n        }).catch(function (error) {\n          console.log(error);\n          store.confirmarVendaTime = true;\n        });\n      }\n    };\n\n    const showMessage = (msg = '', type = 'success') => {\n      const toast = window.Swal.mixin({\n        toast: true,\n        position: 'top',\n        showConfirmButton: false,\n        timer: 3000\n      });\n      toast.fire({\n        icon: type,\n        title: msg,\n        padding: '10px 20px'\n      });\n    };\n\n    return (_ctx, _cache) => {\n      const _directive_focus = _resolveDirective(\"focus\");\n\n      return _openBlock(), _createElementBlock(_Fragment, null, [_createTextVNode(_toDisplayString(_unref(store).confirmarVendaTime) + \" \", 1), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_withDirectives(_createElementVNode(\"input\", {\n        style: {\n          \"max-width\": \"100%\",\n          \"max-height\": \"50px\"\n        },\n        type: \"text\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _unref(store).produtoSearch = $event),\n        placeholder: \"Busca Item...\"\n      }, null, 512), [[_vModelText, _unref(store).produtoSearch]]), _createElementVNode(\"div\", _hoisted_3, [_unref(store).produtoSearch == '' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, _hoisted_6)) : _createCommentVNode(\"\", true), _unref(store).produtoSearch != '' ? (_openBlock(true), _createElementBlock(_Fragment, {\n        key: 1\n      }, _renderList(_unref(store).produtos.filter(f => f.SITUACAO == 'ATIVADO').filter(b => b.NOME.toLowerCase().includes(_unref(store).produtoSearch.toLocaleLowerCase())), (p, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          style: {\n            \"font-size\": \"17px\",\n            \"color\": \"black\"\n          },\n          key: index\n        }, [_createElementVNode(\"div\", {\n          style: {\n            \"display\": \"flex\",\n            \"justify-content\": \"space-between\"\n          },\n          onClick: $event => _unref(incluirProduto)(p.CODIGO_BARRAS)\n        }, [_createElementVNode(\"div\", null, _toDisplayString(p.NOME), 1), _createElementVNode(\"div\", null, \"R$ \" + _toDisplayString(_unref(store).formataDinheiro(p.VALOR)), 1)], 8, _hoisted_7)]);\n      }), 128)) : _createCommentVNode(\"\", true)])]), !_unref(store).recursos.telaCaixaConfirmar ? (_openBlock(), _createElementBlock(\"div\", _hoisted_8, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).CaixaProdutos, (p, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          style: {\n            \"display\": \"flex\",\n            \"justify-content\": \"space-between\"\n          },\n          key: index\n        }, [_createElementVNode(\"div\", null, _toDisplayString(p.QTDE), 1), _createElementVNode(\"div\", null, _toDisplayString(p.NOME), 1), _createElementVNode(\"div\", _hoisted_9, \" R$ \" + _toDisplayString(_unref(store).formataDinheiro(p.VALOR, 2)), 1), _createElementVNode(\"div\", _hoisted_10, [(_openBlock(), _createElementBlock(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"24\",\n          height: \"24\",\n          viewBox: \"0 0 24 24\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          \"stroke-width\": \"2\",\n          \"stroke-linecap\": \"round\",\n          \"stroke-linejoin\": \"round\",\n          class: \"feather feather-trash-2 icon\",\n          onClick: $event => deleteItem(index)\n        }, _hoisted_16, 8, _hoisted_11))])]);\n      }), 128)), _createElementVNode(\"div\", _hoisted_17, [_createTextVNode(\" Qtde: \"), _withDirectives(_createElementVNode(\"input\", {\n        type: \"number\",\n        ref: \"myinput\",\n        style: {\n          \"width\": \"80px\"\n        },\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _unref(store).CaixaProdutos.QTDE = $event),\n        placeholder: \"novo produto\"\n      }, null, 512), [[_directive_focus], [_vModelText, _unref(store).CaixaProdutos.QTDE]]), _createTextVNode(\" Desconto \"), _withDirectives(_createElementVNode(\"input\", {\n        type: \"number\",\n        ref: \"myinput\",\n        style: {\n          \"width\": \"100px\"\n        },\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _unref(store).CaixaProdutos.DESCONTO = $event),\n        placeholder: \"novo produto\"\n      }, null, 512), [[_directive_focus], [_vModelText, _unref(store).CaixaProdutos.DESCONTO]]), _createTextVNode(\" Codigo de Barras \"), _withDirectives(_createElementVNode(\"input\", {\n        type: \"text\",\n        ref: \"myinput\",\n        style: {\n          \"width\": \"200px\"\n        },\n        value: _unref(store).CaixaProdutos.codProduto,\n        onInput: _cache[3] || (_cache[3] = evt => _unref(incluirProduto)(evt.target.value)),\n        placeholder: \"novo produto\"\n      }, null, 40, _hoisted_18), [[_directive_focus]])])])) : _createCommentVNode(\"\", true), _unref(store).recursos.telaCaixaConfirmar ? (_openBlock(), _createElementBlock(\"div\", {\n        key: 1,\n        style: {\n          \"font-size\": \"15px\"\n        },\n        onClick: _cache[4] || (_cache[4] = $event => _unref(store).recursos.telaCaixaConfirmar = false)\n      }, _hoisted_20)) : _createCommentVNode(\"\", true), _unref(store).recursos.telaCaixaConfirmar ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [_createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"div\", _hoisted_23, [_withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => _unref(store).formaPagamento = $event)\n      }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).formasPagamentos, (pg, indexPg) => {\n        return _openBlock(), _createElementBlock(\"option\", {\n          key: indexPg,\n          value: {\n            pgto: pg,\n            index: indexPg\n          }\n        }, _toDisplayString(pg.DESCRICAO), 9, _hoisted_24);\n      }), 128))], 512), [[_vModelSelect, _unref(store).formaPagamento]])]), _createElementVNode(\"div\", null, [_createTextVNode(\" Valor R$ \"), _withDirectives(_createElementVNode(\"input\", {\n        style: {\n          \"width\": \"100px\"\n        },\n        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => _unref(store).saldoPgto = $event),\n        type: \"number\"\n      }, null, 512), [[_vModelText, _unref(store).saldoPgto]])])]), _createElementVNode(\"div\", {\n        style: {\n          \"margin-top\": \"50px\",\n          \"padding\": \"10px\"\n        },\n        onClick: _cache[7] || (_cache[7] = $event => {\n          _unref(store).formasPgtoVenda.push({\n            cod_forma_pgto: _unref(store).formaPagamento.pgto.ID,\n            descricao: _unref(store).formaPagamento.pgto.DESCRICAO,\n            valor: _unref(store).saldoPgto\n          });\n\n          _unref(store).formasPagamentos.splice(_unref(store).formaPagamento.index, 1);\n\n          saldoPgto();\n        })\n      }, _hoisted_26), _createElementVNode(\"div\", null, [_createElementVNode(\"div\", _hoisted_27, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(store).formasPgtoVenda, (p, index) => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          style: {\n            \"display\": \"flex\",\n            \"justify-content\": \"space-between\"\n          },\n          key: index\n        }, [_createElementVNode(\"div\", _hoisted_28, _toDisplayString(p.cod_forma_pgto) + \"-\" + _toDisplayString(p.descricao), 1), _createElementVNode(\"div\", _hoisted_29, \" R$ \" + _toDisplayString(_unref(store).formataDinheiro(p.valor, 2)), 1), _createElementVNode(\"div\", _hoisted_30, [(_openBlock(), _createElementBlock(\"svg\", {\n          xmlns: \"http://www.w3.org/2000/svg\",\n          width: \"24\",\n          height: \"24\",\n          viewBox: \"0 0 24 24\",\n          fill: \"none\",\n          stroke: \"currentColor\",\n          \"stroke-width\": \"2\",\n          \"stroke-linecap\": \"round\",\n          \"stroke-linejoin\": \"round\",\n          class: \"feather feather-trash-2 icon\",\n          onClick: $event => {\n            deletePgto(index);\n            saldoPgto();\n          }\n        }, _hoisted_36, 8, _hoisted_31))])]);\n      }), 128))]), _createElementVNode(\"div\", _hoisted_37, \" SOMA DE PGTO: R$ \" + _toDisplayString(somaValor(_unref(store).formasPgtoVenda.map(x => x.valor))), 1), _createElementVNode(\"div\", _hoisted_38, \" FALTA: R$ \" + _toDisplayString(somaValor(_unref(store).formasPgtoVenda.map(x => x.valor)) - somaCaixa()), 1), _createElementVNode(\"div\", null, [_createTextVNode(\" Calcular Troco: \"), _withDirectives(_createElementVNode(\"input\", {\n        style: {\n          \"text-align\": \"center\",\n          \"width\": \"70px\",\n          \"padding\": \"5px\"\n        },\n        \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => _unref(store).vendaCaixa.valorPago = $event),\n        type: \"number\",\n        placeholder: \"valor Dinheiro\"\n      }, null, 512), [[_vModelText, _unref(store).vendaCaixa.valorPago]])]), _unref(store).vendaCaixa.valorPago > 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_39, \" TROCO: \" + _toDisplayString(_unref(store).formataDinheiro(_unref(store).vendaCaixa.valorPago - somaCaixa(), 2)), 1)) : _createCommentVNode(\"\", true), somaValor(_unref(store).formasPgtoVenda.map(x => x.valor)) == somaCaixa() && _unref(store).confirmarVendaTime ? (_openBlock(), _createElementBlock(\"div\", _hoisted_40, [_createElementVNode(\"button\", {\n        onClick: addVenda\n      }, \"VENDER\")])) : _createCommentVNode(\"\", true)])])) : _createCommentVNode(\"\", true)])], 64);\n    };\n  }\n\n};","map":{"version":3,"mappings":"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","names":["indexStore","useUserStore","axios","store","storeLogin","formasPgtoVenda","CaixaProdutos","QTDE","DESCONTO","VendaEnviada","formaPagamento","produtos","produtoSearch","tipoVenda","confirmarVendaTime","getProdutos","data","JSON","stringify","empresas","schema","config","method","maxBodyLength","Infinity","url","baseApiHTTPS","headers","request","then","response","map","x","itens","ID","id","CATEGORIA","categoria","CODIGO_BARRAS","codigo_barras","DESCRICAO","descricao","FOTO","foto","NOME","nome","SITUACAO","situacao","VALOR","valor","VALOR_CUSTO","valor_custo","QTDE_ESTOQUE","qtde_estoque","push","catch","error","console","log","formasPagamentos","getFormasPgto","PERCENTUAL","taxa","deleteItem","index","splice","somaCaixa","deletePgto","cod_forma_pgto","incluirProduto","codProduto","ItemSelectCaixa","p","item","filter","valorDesconto","COD_PRODUTO","toString","replace","CUSTO","ID_PRODUTO","somarProduto","totalProd","i","somaValor","array","arr","sum","length","saldoPgto","addVenda","SCHEMA","COD_CLIENTE","COD_ENDERECO","TROCO","vendaCaixa","valorTroco","descontos","ITENS","FORMA_PGTO","TIPO_VENDA","PGTO","recursos","telaCaixaConfirmar","showMessage","valorPago","msg","type","toast","window","Swal","mixin","position","showConfirmButton","timer","fire","icon","title","padding"],"sources":["/home/renato/projetos/pdvsmart/src/views/pdv/ListagemProdVenda.vue"],"sourcesContent":["<template>   \n {{ store.confirmarVendaTime }}\n \n<div style=\"display: flex; \n        justify-content: space-between; font-size: 40px; \">\n\n<div \nstyle=\"   padding: 5px; \n          margin-left: -25px;\n          max-width: 400px; \n          font-size: 20px;\">\n\n  <input style=\"max-width: 100%; max-height: 50px;\"\n          type=\"text\" v-model=\"store.produtoSearch\" placeholder=\"Busca Item...\"/> \n  \n  <div\n  class=\"conteudo\"\n  style=\"  height: 60.5vh; \"\n  >\n  <div v-if=\"store.produtoSearch == ''\"> \n    <img \n      style=\"width: 330px; height: 350px;    \"  \n      src=\"https://cdn-icons-png.flaticon.com/512/8146/8146003.png\"\n      class=\"lazy\" alt=\"\">\n  </div> \n\n   <div v-if=\"store.produtoSearch != ''\"   style=\" font-size: 17px;  color: black;\"    \n    v-for=\" (p,index) in store.produtos.filter(f => f.SITUACAO=='ATIVADO').filter(b => b.NOME.toLowerCase().includes(store.produtoSearch.toLocaleLowerCase()))\" :key=\"index\"\n    > \n    \n      <div  style=\"display: flex; \n           justify-content: space-between;  \" \n          @click=\"incluirProduto(p.CODIGO_BARRAS)\" \n          >\n       <div>{{ p.NOME }}</div> \n       <div>R$  {{ store.formataDinheiro(p.VALOR)}} </div>  \n      </div> \n   \n    </div>\n  </div>\n  \n  \n  \n\n</div> \n\n  \n\n   \n  <div \n  v-if=\"!store.recursos.telaCaixaConfirmar\"\n  class=\"conteudo\"\n   style=\"background-color: white;  \n              min-width: 70%; \n              height: 77.0vh;\n              padding-right: 0px;\">\n    <div style=\"display: flex;  \n        justify-content: space-between;  \n        \"  \n        v-for=\" (p,index) in store.CaixaProdutos\" :key=\"index\"\n        >\n \n        <div>{{p.QTDE}} </div>\n        <div>{{p.NOME}}</div>\n     \n    <div style=\"font-size: 40px;  \">\n       R$ {{store.formataDinheiro(p.VALOR,2)  }}\n    </div>\n\n    <div style=\" \">\n      <svg \n                        xmlns=\"http://www.w3.org/2000/svg\"\n                        width=\"24\"\n                        height=\"24\"\n                        viewBox=\"0 0 24 24\"\n                        fill=\"none\"\n                        stroke=\"currentColor\"\n                        stroke-width=\"2\"\n                        stroke-linecap=\"round\"\n                        stroke-linejoin=\"round\"\n                        class=\"feather feather-trash-2 icon\"\n                        @click=\"deleteItem(index)\"\n                    >\n                        <polyline points=\"3 6 5 6 21 6\"></polyline>\n                        <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path>\n                        <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\n                        <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\n                    </svg>\n    </div>\n    \n    \n  </div> \n \n  <div style=\"font-size: 30px; \">\nQtde: \n<input    type=\"number\" \n          ref=\"myinput\"\n          style=\"width: 80px;\"\n          v-focus\n          v-model=\"store.CaixaProdutos.QTDE\" \n          placeholder=\"novo produto\"\n               \n  />\n  Desconto\n  <input    type=\"number\" \n          ref=\"myinput\"\n          style=\"width: 100px;\"\n          v-focus\n          v-model=\"store.CaixaProdutos.DESCONTO\" \n          placeholder=\"novo produto\"\n               \n  />\n Codigo de Barras\n<input     type=\"text\" \n              ref=\"myinput\"\n              v-focus\n              style=\"width: 200px;\"\n              :value='store.CaixaProdutos.codProduto' \n              @input='evt=>incluirProduto(evt.target.value)'\n              placeholder=\"novo produto\"\n               \n  />\n\n\n</div> \n  </div>\n\n  <div  v-if=\"store.recursos.telaCaixaConfirmar\"\n       style=\" font-size:15px ;\n         \"\n  @click=\"store.recursos.telaCaixaConfirmar = false\">\n  <button>Voltar</button>\n  </div>\n\n <div \n       style=\"background-color: rgb(0, 132, 255); color: rgb(3, 0, 0); \n              padding: 15px; text-align: center; display: flex;\n              margin: 10px;\n              justify-content: center;\n              font-size: 20px;\n              min-width: 70%;\n\n              \" \n      v-if=\"store.recursos.telaCaixaConfirmar\">\n \n<div style=\"padding: 20px; \">\n \n <div style=\"padding: 10px;\"  > \n       <select  v-model=\"store.formaPagamento\"\n       \n       >\n        <option \n        \n        v-for=\"pg, indexPg in store.formasPagamentos\" :key=\"indexPg\"\n                :value=\"{pgto: pg, index: indexPg}\">  \n          {{pg.DESCRICAO}}\n        </option> \n       </select>\n </div>\n <div > \n   Valor R$ <input style=\"width: 100px;\"  \n          v-model=\"store.saldoPgto\" type=\"number\" >\n   </div>\n  \n\n</div>      \n\n<div \nstyle=\"margin-top: 50px; padding: 10px;\"\n@click=\"store.formasPgtoVenda.push({cod_forma_pgto: store.formaPagamento.pgto.ID,\n                                          descricao: store.formaPagamento.pgto.DESCRICAO,\n                                          valor:  store.saldoPgto, \n                                        });\n                                        store.formasPagamentos.splice(store.formaPagamento.index,1)\n                                          saldoPgto();\n                                                                                   \n                                          \">\n  \n<svg fill=\"#000000\" version=\"1.1\" id=\"Capa_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n\t width=\"40px\" height=\"40px\" viewBox=\"0 0 199.405 199.405\"\n\t xml:space=\"preserve\">\n<g>\n\t<polygon points=\"99.703,199.405 199.405,99.702 99.703,0 71.418,28.285 124.662,81.529 0,81.529 0,117.876 124.662,117.876 \n\t\t71.418,171.12 \t\"/>\n</g>\n</svg>\n    </div>\n\n<div>\n \n  <div  \n  class=\"conteudo\"\n   style=\"background-color: white;  \n              min-width: 30%; \n             width: 400px;\n             height: 200px;\n             margin-top: 20px;\n              padding-right: 0px;\">\n    <div style=\"display: flex;  \n        justify-content: space-between;  \n        \"  \n        v-for=\" (p,index) in store.formasPgtoVenda\" :key=\"index\"\n        > \n \n        <div style=\"font-size: 20px;  \">\n       {{ p.cod_forma_pgto }}-{{p.descricao}}\n    </div>\n    <div style=\"font-size: 20px;  \">\n       R$ {{store.formataDinheiro(p.valor,2)  }}\n    </div>\n\n    <div style=\" \">\n      <svg \n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"24\"\n            height=\"24\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            stroke-width=\"2\"\n            stroke-linecap=\"round\"\n            stroke-linejoin=\"round\"\n            class=\"feather feather-trash-2 icon\"\n            @click=\"deletePgto(index);saldoPgto()\"\n        >\n            <polyline points=\"3 6 5 6 21 6\"></polyline>\n            <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path>\n            <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\n            <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\n        </svg>\n    </div>\n     \n  </div>  \n\n  </div>\n\n    <div  \n    \n      style=\"background-color: cornsilk;  \n              min-width: 30%; \"\n      >\n      SOMA DE PGTO: R$ {{somaValor(store.formasPgtoVenda.map(x => x.valor))  }}\n    </div>\n\n    <div  \n      style=\"background-color: #0866B8;  \n              min-width: 30%; \"\n      >\n      FALTA: R$ {{somaValor(store.formasPgtoVenda.map(x => x.valor))- somaCaixa()}}\n    </div>\n\n\n\n      <div>\n      Calcular Troco: <input style=\"text-align: center;width: 70px; padding: 5px;\" v-model=\"store.vendaCaixa.valorPago\"  \n                          type=\"number\" \n                          placeholder=\"valor Dinheiro\">  \n    </div> \n\n    <div style=\"font-size: 23px; padding: 5px;\" v-if=\"store.vendaCaixa.valorPago > 0\">\n      TROCO: {{store.formataDinheiro(store.vendaCaixa.valorPago - somaCaixa(),2) }}\n    </div>\n\n    <div \n    v-if=\"somaValor(store.formasPgtoVenda.map(x => x.valor)) ==  somaCaixa() \n    && store.confirmarVendaTime\n    \"\n    style=\"padding:8px;\">\n      <button @click=\"addVenda\">VENDER</button>\n    </div>\n</div>      \n\n   \n  </div>\n\n</div>\n \n</template>\n\n<script setup>\n \nimport {indexStore, useUserStore} from '../../store/indexStore' \nimport axios from 'axios'\nconst store = indexStore(); \nconst storeLogin = useUserStore();\n\nstore.formasPgtoVenda = []\n\n\n \n\nstore.CaixaProdutos.QTDE = 1\nstore.CaixaProdutos.DESCONTO=0\nstore.VendaEnviada = false\nstore.formaPagamento = false\nstore.produtos = []\nstore.produtoSearch = ''\nconst produtos = []\nstore.tipoVenda = 'NORMAL'\n\nstore.confirmarVendaTime = true\n \n \n \nconst getProdutos = (async () => { \n  let data = JSON.stringify({\n  \"SCHEMA\": storeLogin.empresas?.schema\n    });\n\n    let config = {\n      method: 'post',\n      maxBodyLength: Infinity,\n      url: store.baseApiHTTPS+'/getProdutos',\n      headers: { \n        'Content-Type': 'application/json'\n      },\n      data : data\n    };\n\n    axios.request(config)\n    .then((response) => { \n      response.data.map(x=> {\n        const itens ={\n            ID: x.id,\n            CATEGORIA: x.categoria,\n            CODIGO_BARRAS: x.codigo_barras,\n            DESCRICAO: x.descricao,\n            FOTO: x.foto,\n            NOME: x.nome,\n            SITUACAO: x.situacao,\n            VALOR: x.valor,\n            VALOR_CUSTO: x.valor_custo,\n            QTDE_ESTOQUE: x.qtde_estoque,\n            ID: x.id\n       }\n       produtos.push(itens)\n       store.produtos.push(itens)\n       })\n    })\n    .catch((error) => {\n      console.log(error);\n    }); \n\n})\n \n getProdutos()\n\n store.formasPagamentos = [ ]\n\n const getFormasPgto = ()=> {\n    let data = JSON.stringify({\n  \"SCHEMA\": storeLogin.empresas?.schema \n});\n\nlet config = {\n  method: 'post',\n  maxBodyLength: Infinity,\n  url: store.baseApiHTTPS+'/GetFormapagamento',\n  headers: { \n    'Content-Type': 'application/json'\n  },\n  data : data\n};\n\naxios.request(config)\n.then((response) => { \n  response.data.map(x=> {\n        const itens ={\n            ID: x.id,\n            DESCRICAO: x.descricao,\n            PERCENTUAL: x.taxa         \n       }\n       store.formasPagamentos.push(itens)\n       }) \n})\n.catch((error) => {\n  console.log(error);\n});\n}\n\ngetFormasPgto()\n \n const deleteItem = (index) => {\n    console.log(index)\n    store.CaixaProdutos.splice(index, 1);\n    somaCaixa() \n }\n\n const deletePgto = (index) => {\n    console.log(index)\n    store.formasPagamentos.push({ID: store.formasPgtoVenda[index].cod_forma_pgto, DESCRICAO: store.formasPgtoVenda[index].descricao})\n    store.formasPgtoVenda.splice(index, 1);\n }\n \n \nvar incluirProduto = (codProduto) => {\n console.log(codProduto)\n \n  const ItemSelectCaixa = p => p.CODIGO_BARRAS == codProduto\n  const item  = produtos.filter(ItemSelectCaixa)\n  let valorDesconto = store.CaixaProdutos.DESCONTO || 0 \n  \nconsole.log(item)\n  if (item[0]?.CODIGO_BARRAS == codProduto) { \n    store.CaixaProdutos.push({\n                COD_PRODUTO: codProduto,\n                NOME: item[0]?.NOME,\n                QTDE: store.CaixaProdutos.QTDE,\n                VALOR: item[0]?.VALOR * store.CaixaProdutos.QTDE,\n                DESCONTO: valorDesconto.toString().replace(',','.'),\n                CUSTO:  item[0]?.VALOR_CUSTO * store.CaixaProdutos.QTDE,\n                ID_PRODUTO: item[0].ID || 0\n    })\n   \n    \n    somaCaixa() \n     store.CaixaProdutos.QTDE=1\n    store.CaixaProdutos.DESCONTO=0   \n  }    \n}\n\n\nfunction somaCaixa() {\n  var somarProduto = store.CaixaProdutos.map(p =>{\n                return (p.VALOR - p.DESCONTO)\n              } )\n\n  let totalProd = 0\n  for(let i in somarProduto) {\n           totalProd += somarProduto[i] \n          }\n          store.somaCaixa = totalProd\n          return totalProd\n}\n \n\nfunction somaValor(array) { \n  var arr =  array     \n  var sum = 0; \n  for(var i =0;i<arr.length;i++){ \n    sum+=arr[i]; \n  }     \n  return (sum)\n}\n\nfunction saldoPgto(){  \n    store.saldoPgto= somaCaixa() - somaValor(store.formasPgtoVenda.map(x => x.valor))    \n}\n \n\nconst addVenda = async () => {  \n \n  if (store.CaixaProdutos.length > 0 &&  store.formaPagamento && store.confirmarVendaTime) { \n    store.confirmarVendaTime=false\n\nvar data = {   \n      SCHEMA: storeLogin.empresas?.schema  ,\n      COD_CLIENTE: 999,\n      COD_ENDERECO: 1,    \n      VALOR: store.somaCaixa,\n      TROCO: store.vendaCaixa.valorTroco, \n      DESCONTO: store.vendaCaixa.descontos,\n      ITENS: store.CaixaProdutos,\n      FORMA_PGTO: 1,\n      TIPO_VENDA: store.tipoVenda,\n      PGTO: store.formasPgtoVenda\n    }\n\nconsole.log(data)\n\nvar config = {\n  method: 'post',\n  maxBodyLength: Infinity,\n  url: store.baseApiHTTPS+'/vendas',\n  headers: { \n    'Content-Type': 'application/json'\n  },\n  data : data\n};\n\n \n\naxios(config)\n.then(function (response) {\n  console.log(JSON.stringify(response.data));\n  store.CaixaProdutos = []\n  //window.location.href = window.location.href\n  store.somaCaixa = 0\n  store.formaPagamento = false\n  store.produtoSearch = '' \n       store.CaixaProdutos.QTDE=1\n    store.CaixaProdutos.DESCONTO=0\n    store.recursos.telaCaixaConfirmar = false\n  showMessage('venda realizada com sucesso.');\n  store.confirmarVendaTime = true\n  store.formasPgtoVenda = []\n  store.vendaCaixa.valorPago = 0\n})\n.catch(function (error) {\n  console.log(error);\n  store.confirmarVendaTime = true\n});\n   \n\n}} \n\n\nconst showMessage = (msg = '', type = 'success') => {\n        const toast = window.Swal.mixin({\n            toast: true,\n            position: 'top',\n            showConfirmButton: false,\n            timer: 3000,\n        });\n        toast.fire({\n            icon: type,\n            title: msg,\n            padding: '10px 20px',\n        });\n    };\n\n\n</script>\n\n<style>\n  .conteudo {\n    \n    flex-direction: row;\n    /* justify-content: center; */\n    align-items: center;\n    width: 100%;\n    overflow-x: auto;\n}\n</style>"]},"metadata":{},"sourceType":"module"}