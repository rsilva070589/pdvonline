{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, toDisplayString as _toDisplayString, createBlock as _createBlock, createTextVNode as _createTextVNode, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"margin-top\": \"0px\"\n  }\n};\nconst _hoisted_2 = {\n  style: {\n    \"display\": \"flex\"\n  }\n};\nconst _hoisted_3 = {\n  key: 0,\n  style: {\n    \"margin-top\": \"17px\"\n  }\n};\n\nconst _hoisted_4 = /*#__PURE__*/_createElementVNode(\"div\", null, null, -1\n/* HOISTED */\n);\n\nconst _hoisted_5 = {\n  key: 0,\n  style: {\n    \"max-width\": \"90%\"\n  },\n  class: \"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 layout-spacing\"\n};\nconst _hoisted_6 = {\n  class: \"widget widget-unique-visitors\"\n};\n\nconst _hoisted_7 = /*#__PURE__*/_createStaticVNode(\"<div class=\\\"widget-heading\\\"><h5>Vendas Total Mensal</h5><div class=\\\"task-action\\\"><div class=\\\"dropdown btn-group\\\"><a href=\\\"javascript:;\\\" id=\\\"ddlVisitors\\\" class=\\\"btn dropdown-toggle btn-icon-only\\\" data-bs-toggle=\\\"dropdown\\\" aria-expanded=\\\"false\\\"><svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"24\\\" height=\\\"24\\\" viewBox=\\\"0 0 24 24\\\" fill=\\\"none\\\" stroke=\\\"currentColor\\\" stroke-width=\\\"2\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\" class=\\\"feather feather-more-horizontal\\\"><circle cx=\\\"12\\\" cy=\\\"12\\\" r=\\\"1\\\"></circle><circle cx=\\\"19\\\" cy=\\\"12\\\" r=\\\"1\\\"></circle><circle cx=\\\"5\\\" cy=\\\"12\\\" r=\\\"1\\\"></circle></svg></a></div></div></div>\", 1);\n\nconst _hoisted_8 = {\n  class: \"widget-content\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_apexchart = _resolveComponent(\"apexchart\");\n\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", null, [_createVNode(_component_apexchart, {\n    height: \"350\",\n    type: \"bar\",\n    options: $setup.options_3,\n    series: $setup.series_3\n  }, null, 8\n  /* PROPS */\n  , [\"options\", \"series\"])]), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createVNode($setup[\"Filtros\"]), $setup.store.filtro.dataInicial && $setup.store.filtro.dataFinal ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createElementVNode(\"div\", {\n    style: {\n      \"background-color\": \"rgb(153, 193, 134)\",\n      \"margin-top\": \"35px\",\n      \"height\": \"35px\"\n    },\n    class: \"btn btn-primary mt-3\",\n    onClick: _cache[0] || (_cache[0] = $event => $setup.getVendas($setup.tomorrow($setup.store.filtro.dataInicial), $setup.tomorrow($setup.store.filtro.dataFinal)))\n  }, \" buscar \")])) : _createCommentVNode(\"v-if\", true)]), _hoisted_4, (_openBlock(), _createElementBlock(_Fragment, null, _renderList([], (mes, indexMes) => {\n    return _createElementVNode(\"div\", {\n      key: indexMes\n    }, _toDisplayString(mes) + \" - \" + _toDisplayString($setup.formataDinheiro($setup.somaValor($setup.store.itensRelVendas.filter(f => f.DATA == mes).map(x => x.VALOR)))), 1\n    /* TEXT */\n    );\n  }), 64\n  /* STABLE_FRAGMENT */\n  )), $setup.store.relAnual ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, [_hoisted_7, _createElementVNode(\"div\", _hoisted_8, [$setup.options_3 ? (_openBlock(), _createBlock($setup[\"ApexChart\"], {\n    key: 0,\n    height: \"350\",\n    type: \"bar\",\n    options: $setup.unique_visitor_options,\n    series: $setup.series_3\n  }, null, 8\n  /* PROPS */\n  , [\"options\", \"series\"])) : _createCommentVNode(\"v-if\", true), _createTextVNode(\" height=\\\"350\\\" type=\\\"bar\\\" :options=\\\"options_3\\\" :series=\\\"series_3 \")])])])) : _createCommentVNode(\"v-if\", true)])], 64\n  /* STABLE_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":";;EAOKA,KAAuB,EAAvB;IAAA;EAAA;;;EACIA,KAAwB,EAAxB;IAAA;EAAA;;;;EAGOA,KAAyB,EAAzB;IAAA;EAAA;;;gCAYZC,oBACE,KADF,EACE,IADF,EACE,IADF,EACE;AAAA;AADF;;;;EAUKD,KAAuB,EAAvB;IAAA;EAAA;EAAwBE,KAAK,EAAC;;;EAClBA,KAAK,EAAC;;;;;;EA4BFA,KAAK,EAAC;;;;;6DA5D/BD,oBAEM,KAFN,EAEM,IAFN,EAEM,CADFE,aAAuFC,oBAAvF,EAAuF;IAA5EC,MAAM,EAAC,KAAqE;IAA/DC,IAAI,EAAC,KAA0D;IAAnDC,OAAO,EAAEC,gBAA0C;IAA9BC,MAAM,EAAED;EAAsB,CAAvF;;EAAA,wBACE,CAFN,GAKAP,oBAuEM,KAvEN,cAuEM,CAtEFA,oBAcM,KAdN,cAcM,CAbFE,aAAWK,iBAAX,CAaE,EAZaA,aAAME,MAAN,CAAaC,WAAb,IAA4BH,aAAME,MAAN,CAAaE,2BAAxDC,oBAWM,KAXN,cAWM,CATFZ,oBAQM,KARN,EAQM;IARDD,KAGI,EAHJ;MAAA;MAAA;MAAA;IAAA,CAQC;IAJFE,KAAK,EAAC,sBAIJ;IAHDY,OAAK,sCAAEN,iBAAUA,gBAASA,aAAME,MAAN,CAAaC,WAAtB,CAAV,EAA6CH,gBAASA,aAAME,MAAN,CAAaE,SAAtB,CAA7C,CAAF;EAGJ,CARN,EAMa,UANb,CASE,CAXN,sCAYE,CAdN,CAsEE,EAvDFG,UAuDE,iBAjDFF,oBAEMG,SAFN,EAEM,IAFN,EAEMC,YAFsB,EAEtB,EAFwB,CAAlBC,GAAkB,EAAdC,QAAc,KAAN;WAAxBlB,oBAEM,KAFN,EAEM;MAF2BmB,GAAG,EAAED;IAEhC,CAFN,EAA8CE,iBACxCH,GADwC,IACnC,KADmC,GAChCG,iBAAGb,uBAAgBA,iBAAUA,aAAMc,cAAN,CAAqBC,MAArB,CAA4BC,CAAC,IAAGA,CAAC,CAACC,IAAF,IAAUP,GAA1C,EAA+CQ,GAA/C,CAAmDC,CAAC,IAAIA,CAAC,CAACC,KAA1D,CAAV,CAAhB,CAAH,CADd,EAC0G;IAAA;IAD1G;GAEM,CAFN;;EAAA,CAiDE,GA7CuGpB,aAAMqB,0BAA/GhB,oBA0Cc,KA1Cd,cA0Cc,CAzCFZ,oBAwCM,KAxCN,cAwCM,CAvCF6B,UAuCE,EAZF7B,oBAWM,KAXN,cAWM,CAVgBO,kCAAlBuB,aAKavB,mBALb,EAKa;UAAA;IALgBH,MAAM,EAAC,KAKvB;IAL6BC,IAAI,EAAC,KAKlC;IAJRC,OAAO,EAAEC,6BAID;IAHRC,MAAM,EAAGD;EAGD,CALb;;EAAA,6DAUE,mBALW,0EAKX,CAXN,CAYE,CAxCN,CAyCE,CA1Cd,sCA6CE,CAvEN","names":["style","_createElementVNode","class","_createVNode","_component_apexchart","height","type","options","$setup","series","filtro","dataInicial","dataFinal","_createElementBlock","onClick","_hoisted_4","_Fragment","_renderList","mes","indexMes","key","_toDisplayString","itensRelVendas","filter","f","DATA","map","x","VALOR","relAnual","_hoisted_7","_createBlock"],"sourceRoot":"","sources":["/home/renato/projetos/pdvsmart/src/views/dashboard/Dashboard.vue"],"sourcesContent":["<template>\n\n<div>\n    <apexchart height=\"350\" type=\"bar\" :options=\"options_3\" :series=\"series_3\"></apexchart>\n</div>\n\n\n<div style=\"margin-top: 0px\">   \n    <div style=\"display: flex;  \">\n        <Filtros />\n        <div     v-if=\"store.filtro.dataInicial && store.filtro.dataFinal\"\n                style=\"margin-top: 17px;\">\n            <div style=\"background-color: rgb(153, 193, 134);\n                    margin-top: 35px;\n                    height: 35px;\n                    \"\n                class=\"btn btn-primary mt-3\"\n                @click=\"getVendas(tomorrow(store.filtro.dataInicial),tomorrow(store.filtro.dataFinal))\"\n                        >\n                buscar\n            </div>\n        </div> \n    </div>\n    <div> \n</div>\n\n\n\n\n    <div v-for=\"mes,indexMes in []\" :key=\"indexMes\">\n        {{mes}} - {{ formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.DATA == mes).map(x => x.VALOR))) }}   \n    </div>   \n\n    <div style=\"max-width: 90%;\" class=\"col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 layout-spacing\" v-if=\"store.relAnual\"> \n                <div class=\"widget widget-unique-visitors\">\n                    <div class=\"widget-heading\">\n                        <h5>Vendas Total Mensal</h5>\n                        <div class=\"task-action\">\n                            <div class=\"dropdown btn-group\">\n                                <a href=\"javascript:;\" id=\"ddlVisitors\" class=\"btn dropdown-toggle btn-icon-only\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                                    <svg\n                                        xmlns=\"http://www.w3.org/2000/svg\"\n                                        width=\"24\"\n                                        height=\"24\"\n                                        viewBox=\"0 0 24 24\"\n                                        fill=\"none\"\n                                        stroke=\"currentColor\"\n                                        stroke-width=\"2\"\n                                        stroke-linecap=\"round\"\n                                        stroke-linejoin=\"round\"\n                                        class=\"feather feather-more-horizontal\"\n                                    >\n                                        <circle cx=\"12\" cy=\"12\" r=\"1\"></circle>\n                                        <circle cx=\"19\" cy=\"12\" r=\"1\"></circle>\n                                        <circle cx=\"5\" cy=\"12\" r=\"1\"></circle>\n                                    </svg>\n                                </a>\n                               \n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"widget-content\">\n                        <apex-chart v-if=\"options_3\" height=\"350\" type=\"bar\" \n                            :options=\"unique_visitor_options\" \n                            :series=\" series_3  \"\n                     \n                            >\n                        </apex-chart>\n                        height=\"350\" type=\"bar\" :options=\"options_3\" :series=\"series_3\n\n                       \n\n                    </div>\n                </div>\n            </div>\n \n \n</div>\n</template>\n\n<script setup> \n    import Progress from '@/components/Progress.vue';   \n    import { onMounted, ref, computed } from 'vue';\n    import axios from 'axios'\n    import { useMeta } from '@/composables/use-meta';\n    // import Filtros from './Filtros.vue'\n    import ApexChart from 'vue3-apexcharts';  \n    import {indexStore, useUserStore} from '../../store/indexStore'\n    import Filtros from './Filtros.vue'\n    useMeta({ title: 'Multiple Tables' }); \n    const code_arr = ref([]); \n    const store = indexStore(); \n    const storeLogin = useUserStore();\n\n    store.relAnual = []\n    store.anoSelecionado = dataAno(new Date()) \n \n\n    onMounted(() => {\n        bind_data(); \n    });\n\n    const bind_data = async  () => { \n        getFormasPgto()\n    }\n\n    store.formasPagamentos = []\n\nconst getFormasPgto = () => {\n      let data = JSON.stringify({\n  \"SCHEMA\": storeLogin.empresas?.schema \n  });\n\n  let config = {\n  method: 'post',\n  maxBodyLength: Infinity,\n  url: store.baseApiHTTPS+'/GetFormapagamento',\n  headers: { \n      'Content-Type': 'application/json'\n  },\n  data : data\n  };\n\n  axios.request(config)\n  .then((response) => { \n  response.data.map(x=> {\n          const itens ={\n              ID: x.id,\n              DESCRICAO: x.descricao,\n              PERCENTUAL: x.taxa         \n      }\n      store.formasPagamentos.push(itens)\n      }) \n  })\n  .catch((error) => {\n  console.log(error);\n  });\n  }\n\n    function getVendas(dataIni, dataFim){\n        store.itensRelVendas = []\n\n        let data = JSON.stringify({\n        \"DATAINI\": '01/01/2024',\n        \"DATAFIM\": dataFim,\n        \"SCHEMA\": 'MERCEARIABRAGATTO'\n        });\n\n        let config = {\n        method: 'post',\n        maxBodyLength: Infinity,\n        url: store.baseApiHTTPS+'/periodovendas',\n        headers: { \n            'Content-Type': 'application/json'\n        },\n        data : data\n        };\n\n        axios.request(config)\n        .then((response) => {\n            response.data.filter(f=> f.tipo_venda=='NORMAL').map(x =>{\n                const dados = { \n                    ID: x.id,\n                    MES: dataMes(x.data),\n                    ANO: dataAno(x.data),\n                    CATGO: x.categoria,\n                    PRODUTO: x.cod_produto,\n                    NOME: x.nome,\n                    QTDE: x.qtde,\n                    NOME: x.nome, \n                    VALOR: x.valor,\n                    CUSTO: x.custo,\n                    LUCRO: arredonda(x.lucro,2),\n                    PERC_LUCRO: arredonda(x.perc_lucro,2),\n                    FORMA_PGTO: x.forma_pgto,\n                    TIPO_VENDA: x.tipo_venda\n                } \n                store.itensRelVendas.push(dados)\n            })\n            calculaMes()\n        })\n        .catch((error) => {\n        console.log(error);\n        }); \n    }\n\n    var arredonda = function(numero, casasDecimais) {   \n    casasDecimais = typeof casasDecimais !== 'undefined' ?  casasDecimais : 0;\n    numero = typeof numero !== 'undefined' ?  numero : 0;\n    return +(Math.floor(numero + ('e+' + casasDecimais)) + ('e-' + casasDecimais));\n    };\n\n    function somaValor(array) { \n            var arr =  array     \n            var sum = 0; \n            for(var i =0;i<arr.length;i++){ \n              sum+=arr[i]; \n            }               \n            return sum\n          }\n\n   function formataDinheiro(item) {\n             let venda = item;\n             if (!!venda && venda.toString().includes(\",\")) {\n               venda = venda.toString().replace(\",\", \".\");\n             }\n             return parseFloat(venda)\n               .toFixed(2)\n               .replace(\".\", \",\")\n               .replace(/(\\d)(?=(\\d{3})+\\,)/g, \"$1.\");\n        }\n\n   function dataMes(d){ \n        var data =  new Date(d),\n            dia  = data.getDate().toString(),\n            diaF = (dia.length == 1) ? '0'+dia : dia,\n            mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.\n            mesF = (mes.length == 1) ? '0'+mes : mes,\n            anoF = data.getFullYear();\n        return mesF \n        }\n\n        function dataAno(d){ \n        var data =  new Date(d),\n            dia  = data.getDate().toString(),\n            diaF = (dia.length == 1) ? '0'+dia : dia,\n            mes  = (data.getMonth()+1).toString(), //+1 pois no getMonth Janeiro começa com zero.\n            mesF = (mes.length == 1) ? '0'+mes : mes,\n            anoF = data.getFullYear();\n        return  anoF;\n        }\n\n function tomorrow  (dt)  {\n  \n  // Creating the date instance\n  let d = new Date(dt);\n\n  // Adding one date to the present date\n  d.setDate(d.getDate() + 1);\n\n  let year = d.getFullYear()\n  let month = String(d.getMonth() + 1)\n  let day = String(d.getDate())\n  let mes = null\n\n  // Adding leading 0 if the day or month\n  // is one digit value\n  month = month.length == 1 ? \n      month.padStart('2', '0') : month;\n\n   //   if(month == '01'){ mes = 'Jan' }\n   //   if(month == '02'){ mes = 'Feb' }\n   //   if(month == '03'){ mes = 'Mar' }\n   //   if(month == '04'){ mes = 'Apr' }\n   //   if(month == '05'){ mes = 'May' }\n   //   if(month == '06'){ mes = 'Jun' }\n   //   if(month == '07'){ mes = 'Jul' }\n   //   if(month == '08'){ mes = 'Aug' }\n   //   if(month == '09'){ mes = 'Sept' }\n   //   if(month == '10'){ mes = 'Oct' }\n   //   if(month == '11'){ mes = 'Nov' }\n   //  if(month == '12'){ mes = 'Dec' }        \n\n\n  day = day.length == 1 ? \n      day.padStart('2', '0') : day;\n\n  // Printing the present date \n  return(`${day}/${month}/${year}`);\n  }\n\n  function calculaMes(){\n     store.relAnual = [\n        {\n            mes: 'janeiro',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '01' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'fevereiro',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '02' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'marco',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '03' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'abril',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '04' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'maio',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '05' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'junho',\n            total: (somaValor(store.itensRelVendas.filter(f=> f.MES == '06' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'julho',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '07' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'agosto',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '08' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'setembro',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '09' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'outubro',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '10' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'novembro',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '11' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        },\n        {\n            mes: 'desembro',\n            total: formataDinheiro(somaValor(store.itensRelVendas.filter(f=> f.MES == '12' && f.ANO==store.anoSelecionado).map(x => x.VALOR)))\n        }\n    ]  \n  }\n   \n \nconst options_3 =  computed(() => {\n    return {\n        chart: { toolbar: { show: false } }, dataLabels: { enabled: false }, stroke: { show: true, width: 2, colors: ['transparent'] },\n    plotOptions: { bar: { horizontal: false, columnWidth: '55%', borderRadius: 8 }, },\n    xaxis: { categories: ['Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct'], },\n    yaxis: { title: { text: '$ (thousands)' } },\n    fill: { opacity: 1 },\n    tooltip: { y: { formatter: function (val) { return \"$ \" + val + \" thousands\" } } }\n    }\n  \n})\nconst series_3 =   computed(() => {\n    return  \n        [{ name: 'Net Profit', data: [44, 55, 57, 56, 61, 58, 63, 60, 66] }, { name: 'Revenue', data: [76, 85, 101, 98, 87, 105, 91, 114, 94] }]\n}) \n    \n\n\n  const unique_visitor_options = computed(() => {\n        \n        return {\n            chart: { height: 350,      type: 'bar'},\n            dataLabels: { enabled: !store.detectar_mobile(), formatter: function (val) {return \"R$ \" +(val) },\n              offsetY: -20,\n              style: {\n                fontSize: '11px',\n                colors: [\"#888EA8\"]\n              }              \n            },\n             \n            colors: ['#5c1ac3'],\n\n            plotOptions: {\n              bar: {\n                columnWidth: '90%',\n                borderRadius: 0,\n                dataLabels: {\n                  position: 'top', // top, center, bottom\n                },\n              }\n            },\n            legend: { position: 'bottom', horizontalAlign: 'center', fontSize: '14px', markers: { width: 12, height: 12 }, itemMargin: { horizontal: 7, vertical: 8 } },\n            grid: { borderColor:  '#e0e6ed' },\n            xaxis: {\n                categories: ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'],\n                axisBorder: { show: true, color:   '#e0e6ed' },\n                \n            },\n            yaxis: {\n                tickAmount: 6,\n            },\n            fill: {\n                type: 'gradient',\n                gradient: { shade:  'light', type: 'vertical', shadeIntensity: 0.3, inverseColors: false, opacityFrom: 1, opacityTo: 0.8, stops: [0, 100] },\n            },\n            tooltip: {\n                theme:  'light',\n                y: {\n                    formatter: function (val) {\n                        return val;\n                    },\n                },\n            },\n        };\n    });\n\n\n     \n    \n</script>"]},"metadata":{},"sourceType":"module"}